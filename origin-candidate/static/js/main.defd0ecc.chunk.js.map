{"version":3,"sources":["util/toJSON.js","epics/verification.js","index.js","util/createAction.js","actions/ad.js","actions/config.js","actions/test.js","actions/tracking.js","actions/vast.js","actions/verification.js","actions/video.js","actions/vpaid.js","settings.js","config.js","containers/ApplyConfig.js","components/Checkbox.js","components/Fieldset.js","components/Header.js","components/Switch.js","components/TextInput.js","constants/verification.js","util/mapObject.js","util/msToString.js","containers/Config.js","util/stringify.js","components/KeyValue.js","components/Placeholder.js","components/Log.js","containers/Log.js","components/Collapsible.js","style/theme.js","components/JSONTree.js","util/replaceKey.js","util/startsWith.js","containers/VastDetails.js","containers/VerificationDetails.js","containers/VideoDetails.js","containers/VpaidDetails.js","components/Details.js","constants/dom.js","containers/VideoPlayer.js","containers/Runner.js","components/Modal.js","middleware/history.js","containers/Share.js","components/About.js","components/App.js","epics/ad.js","epics/config.js","epics/test.js","epics/tracking.js","util/errorToString.js","util/removeKey.js","util/sharedDom.js","util/xml.js","epics/vast.js","constants/vast.js","constants/video.js","util/clamp.js","util/isThenable.js","epics/video.js","constants/vpaid.js","util/loadScript.js","util/vpaidObservable.js","epics/vpaid.js","epics/index.js","middleware/index.js","reducers/ad.js","reducers/config.js","util/isEmpty.js","reducers/log.js","util/incrementCounter.js","reducers/vast.js","reducers/verification.js","reducers/video.js","reducers/vpaid.js","reducers/index.js"],"names":["type","omsdk","iframe","adSession","adEvents","mediaEvents","middleware","createAction","payload","SCHEDULE_AD_START","START_AD","REQUEST_AD_MUTED","REQUEST_AD_PAUSED","REQUEST_AD_FULLSCREEN","REQUEST_AD_SKIP","SET_AD_ACTIVE","SET_AD_PAUSED","SET_AD_MUTED","SET_AD_FULLSCREEN","AD_STOPPED","setAdMuted","muted","setAdPaused","paused","adVolumeChange","adStopped","errorType","message","SET_CONFIG","setConfig","config","START_TEST","END_TEST","VAST_TRACKER","VAST_WARNING","LOAD_VAST","VAST_LOADED","VAST_LOAD_FAILED","UNSUPPORTED_MEDIA_FILES","SET_MEDIA_FILE","VAST_EVENT","setMediaFile","url","apiFramework","adParameters","vastEvent","VERIFICATION_READY","VERIFICATION_SESSION_FINISHED","VERIFICATION_EVENT","VERIFICATION_ERROR_EVENT","verificationEvent","REQUEST_VIDEO_ELEMENT_UPDATE","SET_VIDEO_ELEMENT","SET_VIDEO_SRC","SET_VIDEO_PAUSED","SET_VIDEO_MUTED","SET_VIDEO_PROPERTIES","VIDEO_PLAY_PROMISE","VIDEO_PLAY_NO_PROMISE","VIDEO_PLAY_PROMISE_FULFILLED","VIDEO_PLAY_PROMISE_REJECTED","VIDEO_EVENT","setVideoSrc","src","setVideoPaused","setVideoMuted","setVideoProperties","properties","REQUEST_VPAID_DOM_UPDATE","SET_VPAID_DOM","VPAID_WARNING","VPAID_ERROR","LOAD_VPAID","VPAID_HANDSHAKE_SUCCESSFUL","START_VPAID_AD","VPAID_EVENT","SET_VPAID_PROPERTIES","CALL_VPAID_FUNCTION","CALLING_VPAID_FUNCTION","VPAID_LOADED","VPAID_LOAD_FAILED","callVpaidFunction","name","args","callingVpaidFunction","window","location","protocol","host","APP_NAME","process","APP_VERSION","APP_BRANCH","APP_BUILD_DATE","APP_URL","DEFAULT_VAST_URL","PRELOAD_SIMULATION_TIME","ConfigSchema","vastUrl","default","audioUnmuted","startDelayed","vpaidEnabled","vpaidPropertiesAllowedBeforeAdLoaded","omAccessMode","normalize","Object","entries","reduce","acc","key","value","isUnset","isBooleanKey","parseConfig","str","qs","parse","stringifyConfig","stringify","ApplyConfig","b","this","props","onApplyConfig","newConfig","search","substr","React","Component","connect","dispatch","counter","Checkbox","memo","label","tooltip","defaultValue","onChange","id","className","htmlFor","title","icons","defaultChecked","evt","target","checked","Fieldset","legend","children","Header","onActivateCopyLink","onActivateAbout","to","href","rel","Switch","options","map","idx","onClick","TextInput","minRows","maxRows","VERIFICATION_EVENT_TYPES","mapObject","keys","obj","msToString","ms","atob","btoa","VERIFICATION_ACCESS_MODE_OPTIONS","upperCaseFirst","reBase64DataUri","fromDataUri","uri","match","exec","_","toDataUri","trim","charAt","Config","onResetConfig","state","onSubmit","event","preventDefault","_runButton","click","_onVastUrlChange","bind","_onChange","pathname","innerRef","ref","setState","toInfo","proto","desc","getOwnPropertyDescriptor","hasGetter","get","getName","propertiesToJSON","o","names","seen","ok","err","circularToJSON","converters","test","convert","Array","isArray","a","e","nodeName","el","TimeRanges","ranges","$type","data","length","i","start","end","TextTrackList","prototype","call","toArray","constructor","lookup","create","getters","getOwnPropertyNames","filter","elem","getPrototypeOf","listGetters","includes","push","json","res","splice","toJSON","JSON","KeyValue","sort","nowrap","serializer","wrapClass","cssKey","replace","valueStr","Fragment","data-key","data-value","Placeholder","LEVEL_TO_ICON","info","warn","error","LogItem","timestamp","timeDelta","timeTotal","level","category","text","metadata","classNames","toLowerCase","timeTooltip","textWithMetadata","format","colSpan","PureComponent","Log","_containerRef","createRef","prevProps","events","parent","current","parentNode","scrollTop","clientHeight","scrollHeight","prevState","snapshot","querySelector","scrollIntoView","startTime","log","Collapsible","open","transitionTime","theme","extend","baseTheme","tree","marginTop","marginBottom","valueRenderer","rendered","raw","JSONTree","replaceKey","from","clone","startsWith","prefix","kType","Symbol","renderItem","itemType","itemString","VastTagOutline","vast","getItemString","VastDetails","eventCounts","chain","mediaFileUrl","trigger","URL","mediaFile","VerificationDetails","accessMode","scripts","vendor","verificationParameters","Vendor","Parameters","verification","stringifiers","join","stringifyProperties","out","VideoDetails","video","VpaidDetails","status","Status","vpaid","Details","logOnly","verificationEnabled","disabled","VIDEO_ELEMENT_ID","SLOT_ELEMENT_ID","VPAID_IFRAME_ID","VPAID_IFRAME_HTML","kLoadedSrc","acceptVideoRef","callback","shared","videoMuted","element","defaultMuted","load","acceptIframeRef","doc","contentWindow","document","write","close","videoSrc","videoPaused","ad","adActive","active","adPaused","adMuted","adFullscreen","fullscreen","onVideoElementRef","onVpaidIframeLoaded","onSetAdPaused","onSetAdMuted","onSetAdFullscreen","onSkipAd","playsInline","onLoad","verifications","vastLoaded","mediaFileIsVpaid","hasVerificationScripts","withRouter","history","goBack","historyMiddleware","store","next","action","_ts","Date","now","getBaseUrl","onActivateDownloadLog","blob","Blob","version","saveAs","readOnly","About","App","exact","path","component","Share","mapVastEventsToAdActive","vastEvents","action$","pipe","ofType","indexOf","mapTo","setAdActive","combineEpics","Boolean","mergeMap","$combineLatest","takeUntil","delayed","settings","result","$of","delay","distinctUntilChanged","skip","configEpic","actions","testEpic","getVastTrackingUris","inLine","impressions","it","errors","linear","videoClicks","clickTrackings","trackingEvents","state$","withLatestFrom","uris","vastTrackerFired","errorToString","serializeError","removeKey","values","vpaidIframe","videoElement","slotElement","sharedDom","childNodes","child","descendants","last","slice","pop","descendant","warnings$","Subject","vastWarning","getAdFromVast","adPod","ads","Error","parseVerificationInstance","jsResource","javaScriptResources","parameters","parseVerificationElement","node","omidJsResource","xmlUtil","find","resource","getAttribute","params","textContent","xmlToJSON","loadAndAnalyzeVastChain","$from","VASTLoader","noSingleAdPods","wrappers","inLineVast","loadVastChain","linearCreatives","creatives","creative","getLinearFromInLine","types","getTrackingEventsFromLinear","flatten","vast4Verifications","extVerifications","extensions","extension","xmlElement","selectVideos","mediaFiles","response","canPlayType","selectByDimensions","maxWidth","maxHeight","sorted","width","height","sortByDimensions","selectMediaFile","vpaidMedia","vanillaMedia","triageMediaFiles","offsetWidth","offsetHeight","canProbablyPlay","canMaybePlay","$merge","catchError","vastLoadFailed","results","QUARTILE_EVENTS","tearDown","removeChild","createResources","VerificationScriptResource","createContext","resources","serviceWindow","partner","Partner","context","Context","underEvaluation","setVideoElement","setServiceWindow","createAdSession","AdSession","setCreativeType","setUpAdSession","Promise","resolve","reject","createElement","sandbox","style","display","srcdoc","addEventListener","body","appendChild","OmidSessionClient","AdEvents","MediaEvents","filterVASTEvents","enabled","verificationReady","tap","loaded","VastProperties","impressionOccurred","verificationErrorEvent","vastState","vpaidState","videoState","adDuration","adVolume","duration","volume","mergeMapTo","finish","ignoreElements","VAST_QUARTILE_EVENT_TYPES","VAST_EVENT_TYPES","VIDEO_EVENT_TYPES","VIDEO_PROPERTY_NAMES","clamp","min","max","Math","isThenable","then","normalizeVideoProperties","withoutApiFramework","toVastMediaFileActionStream","toVideoEventStream","desiredType","filterEnded","ended","videoEventToVastEventEpic","videoEventType","vastEventType","once","unlessEnded","take","videoEventToAdEventEpic","adEvent","getElementById","Observable","observer","ownerDocument","onVideoEvent","videoEvent","onFullscreenchange","isFullscreen","fullscreenElement","removeEventListener","EMPTY$","pause","maybeThenable","play","$concat","videoPlayPromiseRejected","played","floor","sum","quartile","distinct","readyState","subject","func","promise","VPAID_EVENT_NAMES","VPAID_PROPERTY_NAMES","VPAID_EVENT_TYPE_TO_VAST_EVENT_TYPE","AdLoaded","AdSkipped","AdStarted","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdClickThru","AdError","loadScript","crossOrigin","script","getElementsByTagName","INVOKE","RETURN_VALUE","EVENT","invoke","allowError","vpaidObservable","in$","out$","subscribe","apply","attemptCall","cause","console","returnValue","PLAY_EVENTS","PAUSE_EVENTS","withVpaidApiFramework","toVpaidMediaFileActionStream","runVpaidAd","win","vpaidAd","getVPAIDAd","adLoadedPublished","silent","takeUntilEndTest","updateProperties$","getter","collectProperties","setVpaidProperties","$interval","returnValueHandlers","handshakeVersion","defaultView","innerWidth","innerHeight","AdParameters","slot","videoSlot","initAd","eventHandlers","AdStopped","handlers","prop","lowerCaseFirst","vpaidEvent","complete","isStrictlyPositive","val","isFinite","adEpic","vastEpic","vastTrackingEpic","verificationEpic","videoEpic","loadVpaid","vpaidLoadFailed","stack","adWidth","adHeight","defaultState","reducer","handleActions","isEmpty","LOGGED_VIDEO_EVENTS","INFO","WARN","ERROR","VAST","VPAID","VIDEO","OMID","HANDLERS","Args","Data","Cause","consoleEnabled","hasOwnProperty","handler","incrementCounter","counts","isVpaid","operationToStatus","startAd","stopAd","eventToStatus","combineReducers","rootEpic","epics","epicMiddleware","createEpicMiddleware","createStore","applyMiddleware","run","dom","render"],"mappings":"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","file":"static/js/main.defd0ecc.chunk.js","sourcesContent":["import mapObject from './mapObject'\n\nconst toInfo = proto => name => ({\n  name,\n  desc: Object.getOwnPropertyDescriptor(proto, name)\n})\n\nconst hasGetter = ({ desc }) => desc.get != null\n\nconst getName = ({ name }) => name\n\nconst listGetters = proto => {\n  const lookup = Object.create(null)\n  while (proto != null && proto !== Object.prototype) {\n    const getters = Object.getOwnPropertyNames(proto)\n      .filter(elem => elem !== 'constructor')\n      .map(toInfo(proto))\n      .filter(hasGetter)\n      .map(getName)\n    for (const name of getters) {\n      lookup[name] = true\n    }\n    proto = Object.getPrototypeOf(proto)\n  }\n  return Object.keys(lookup)\n}\n\nconst convertElement = el => '' + el\n\nconst convertTimeRanges = ranges => ({\n  $type: 'TimeRanges',\n  data: [...Array(ranges.length).keys()].map(i => ({\n    start: ranges.start(i),\n    end: ranges.end(i)\n  }))\n})\n\nconst convertArrayLike = type => (obj, seen) => ({\n  $type: type,\n  data: Array.prototype.map.call(obj, e => circularToJSON(e, seen))\n})\n\nconst propertiesToJSON = (o, names, seen) =>\n  mapObject(names, name => {\n    let value, ok\n    try {\n      value = o[name]\n      ok = true\n    } catch (err) {\n      value = err\n      ok = false\n    }\n    return ok ? circularToJSON(value, seen) : `[Error: ${value}]`\n  })\n\nconst converters = [\n  { test: o => o == null, convert: () => null },\n  { test: o => typeof o !== 'object', convert: o => o },\n  {\n    test: Array.isArray,\n    convert: (a, seen) => a.map(e => circularToJSON(e, seen))\n  },\n  { test: o => typeof o.nodeName === 'string', convert: convertElement },\n  { test: o => o instanceof window.TimeRanges, convert: convertTimeRanges },\n  {\n    test: o => o instanceof window.TextTrackList,\n    convert: convertArrayLike('TextTrackList')\n  },\n  {\n    test: o => o.$type === 'SortedList',\n    convert: (o, seen) => circularToJSON(o.toArray(), seen)\n  },\n  {\n    test: o =>\n      o.constructor != null && o.constructor.prototype !== Object.prototype,\n    convert: (o, seen) =>\n      propertiesToJSON(o, listGetters(o.constructor.prototype), seen)\n  },\n  {\n    test: () => true,\n    convert: (o, seen) => propertiesToJSON(o, Object.keys(o), seen)\n  }\n]\n\nconst circularToJSON = (value, seen) => {\n  // TODO Identify circular refs\n  if (seen.includes(value)) {\n    return '[Circular]'\n  }\n  seen.push(value)\n  const idx = seen.length - 1\n  const json = converters.reduce(\n    (res, { test, convert }) =>\n      !res.ok && test(res.value)\n        ? { ok: true, value: convert(res.value, seen) }\n        : res,\n    {\n      ok: false,\n      value\n    }\n  ).value\n  seen.splice(idx, 1)\n  return json\n}\n\nconst toJSON = value => circularToJSON(value, [])\n\nexport default toJSON\n","import { combineEpics, ofType } from 'redux-observable'\nimport { combineLatest as $combineLatest } from 'rxjs'\nimport {\n  delay,\n  filter,\n  ignoreElements,\n  map,\n  mapTo,\n  mergeMap,\n  mergeMapTo,\n  takeUntil,\n  tap\n} from 'rxjs/operators'\n\nimport {\n  AD_STOPPED,\n  END_TEST,\n  SET_CONFIG,\n  SET_VIDEO_ELEMENT,\n  VAST_EVENT,\n  VAST_LOADED,\n  VERIFICATION_READY,\n  verificationErrorEvent,\n  verificationEvent,\n  verificationReady,\n  verificationSessionFinished\n} from '../actions'\nimport sharedDom from '../util/sharedDom'\n\nconst VIDEO_POSITION = 'standalone'\nconst FINISH_DELAY = 1000\n\nconst QUARTILE_EVENTS = [\n  'firstQuartile',\n  'midpoint',\n  'thirdQuartile',\n  'complete'\n]\n\nlet omsdk, iframe, adSession, adEvents, mediaEvents\n\nconst tearDown = () => {\n  if (iframe == null) {\n    return\n  }\n  iframe.parentNode.removeChild(iframe)\n  mediaEvents = null\n  adEvents = null\n  adSession = null\n  iframe = null\n  omsdk = null\n}\n\nconst createSdkIframe = () =>\n  new Promise((resolve, reject) => {\n    const iframe = document.createElement('iframe')\n    iframe.sandbox = 'allow-scripts allow-same-origin'\n    iframe.style.display = 'none'\n    iframe.srcdoc = ['omweb-v1.js', 'omid-session-client-v1.js']\n      .map(src => `<script src=\"fixtures/omid/${src}\"></script>`)\n      .join('')\n    iframe.addEventListener('load', () => {\n      resolve(iframe)\n    })\n    iframe.addEventListener('error', () => {\n      reject(new Error('Unknown error'))\n    })\n    document.body.appendChild(iframe)\n  })\n\nconst createResources = (verifications, accessMode) =>\n  verifications.map(\n    ({ uri, vendor, verificationParameters }) =>\n      new omsdk.VerificationScriptResource(\n        uri,\n        vendor,\n        verificationParameters,\n        accessMode\n      )\n  )\n\nconst createContext = (resources, serviceWindow) => {\n  const partner = new omsdk.Partner(\n    process.env.REACT_APP_VENDOR + ' ' + process.env.REACT_APP_NAME,\n    process.env.REACT_APP_VERSION\n  )\n  const context = new omsdk.Context(partner, resources, null)\n  context.underEvaluation = true\n  context.setVideoElement(sharedDom.videoElement)\n  context.setServiceWindow(serviceWindow)\n  return context\n}\n\nconst createAdSession = context => {\n  const adSession = new omsdk.AdSession(context)\n  adSession.setCreativeType('video')\n  return adSession\n}\n\nconst setUpAdSession = async (verifications, accessMode) => {\n  tearDown()\n  iframe = await createSdkIframe()\n  const serviceWindow = iframe.contentWindow\n  omsdk = serviceWindow.OmidSessionClient.default\n  adSession = createAdSession(\n    createContext(createResources(verifications, accessMode), serviceWindow)\n  )\n  adEvents = new omsdk.AdEvents(adSession)\n  mediaEvents = new omsdk.MediaEvents(adSession)\n  adSession.start()\n}\n\nconst filterVASTEvents = (action$, type) =>\n  action$.pipe(\n    ofType(VAST_EVENT),\n    filter(({ payload }) => payload.type === type)\n  )\n\nconst startVerificationSessionWhenVastAndVideoAvailableEpic = action$ =>\n  action$.pipe(\n    ofType(SET_CONFIG),\n    map(({ payload: config }) => config),\n    filter(Boolean),\n    mergeMap(({ omAccessMode }) =>\n      $combineLatest(\n        action$.pipe(ofType(VAST_LOADED)),\n        action$.pipe(ofType(SET_VIDEO_ELEMENT))\n      ).pipe(\n        map(([{ payload }]) => payload.verifications),\n        mergeMap(async verifications => {\n          const enabled = verifications.length > 0\n          if (enabled) {\n            await setUpAdSession(verifications, omAccessMode)\n          }\n          return enabled\n        }),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    map(enabled => verificationReady(enabled))\n  )\n\nconst dispatchLoadedEpic = action$ =>\n  filterVASTEvents(action$, 'loaded').pipe(\n    tap(() => {\n      if (adEvents != null) {\n        // TODO Get skip information from VAST\n        const isSkippable = true\n        const skipOffset = 0\n        const isAutoPlay = true\n        adEvents.loaded(\n          new omsdk.VastProperties(\n            isSkippable,\n            skipOffset,\n            isAutoPlay,\n            VIDEO_POSITION\n          )\n        )\n      }\n    }),\n    mapTo(verificationEvent('loaded'))\n  )\n\nconst dispatchImpressionEpic = action$ =>\n  filterVASTEvents(action$, 'impression').pipe(\n    tap(() => {\n      if (adEvents != null) {\n        adEvents.impressionOccurred()\n      }\n    }),\n    mapTo(verificationEvent('impression'))\n  )\n\nconst dispatchErrorEpic = action$ =>\n  action$.pipe(\n    ofType(AD_STOPPED),\n    map(({ payload }) => payload),\n    filter(Boolean),\n    tap(({ errorType, message }) => {\n      if (adSession != null) {\n        adSession.error(errorType, message)\n      }\n    }),\n    map(({ errorType, message }) => verificationErrorEvent(errorType, message))\n  )\n\nconst dispatchStartEpic = (action$, state$) =>\n  filterVASTEvents(action$, 'start').pipe(\n    tap(() => {\n      if (mediaEvents != null) {\n        const {\n          vast: vastState,\n          vpaid: vpaidState,\n          video: videoState\n        } = state$.value\n        const [duration, volume] =\n          vastState.mediaFile.apiFramework === 'VPAID'\n            ? [vpaidState.properties.adDuration, vpaidState.properties.adVolume]\n            : [videoState.properties.duration, videoState.properties.volume]\n        mediaEvents.start(duration, volume)\n      }\n    }),\n    mapTo(verificationEvent('start'))\n  )\n\nconst dispatchQuartilesEpic = action$ =>\n  action$.pipe(\n    ofType(VAST_EVENT),\n    map(({ payload: { type } }) => type),\n    filter(type => QUARTILE_EVENTS.includes(type)),\n    tap(type => {\n      if (mediaEvents != null) {\n        mediaEvents[type]()\n      }\n    }),\n    map(type => verificationEvent(type))\n  )\n\nconst finishSessionEpic = action$ =>\n  action$.pipe(\n    ofType(VERIFICATION_READY),\n    filter(({ payload }) => payload.enabled),\n    mergeMapTo(\n      filterVASTEvents(action$, 'complete').pipe(\n        delay(FINISH_DELAY),\n        tap(() => {\n          adSession.finish()\n        }),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    mapTo(verificationSessionFinished())\n  )\n\nconst tearDownOnEndEpic = action$ =>\n  action$.pipe(\n    ofType(END_TEST),\n    tap(() => {\n      tearDown()\n    }),\n    ignoreElements()\n  )\n\nexport default combineEpics(\n  startVerificationSessionWhenVastAndVideoAvailableEpic,\n  dispatchLoadedEpic,\n  dispatchImpressionEpic,\n  dispatchErrorEpic,\n  dispatchStartEpic,\n  dispatchQuartilesEpic,\n  finishSessionEpic,\n  tearDownOnEndEpic\n)\n","import 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\n\nimport React from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { applyMiddleware, createStore } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport { createLogger } from 'redux-logger'\nimport { combineEpics, createEpicMiddleware } from 'redux-observable'\n\nimport App from './components/App'\nimport epics from './epics'\nimport middleware from './middleware'\nimport reducer from './reducers'\n\nconst composeMiddleware = middleware => {\n  if (process.env.NODE_ENV === 'development') {\n    if (\n      window.localStorage != null &&\n      window.localStorage.reduxLogger === 'true'\n    ) {\n      middleware.push(createLogger())\n    }\n    return composeWithDevTools(applyMiddleware(...middleware))\n  } else {\n    return applyMiddleware(...middleware)\n  }\n}\n\nconst rootEpic = combineEpics(...epics)\nconst epicMiddleware = createEpicMiddleware()\nconst store = createStore(\n  reducer,\n  composeMiddleware([...middleware, epicMiddleware])\n)\nepicMiddleware.run(rootEpic)\nconst dom = (\n  <Provider store={store}>\n    <App />\n  </Provider>\n)\nrender(dom, document.getElementById('root'))\n","const createAction = (type, payload = null) => ({ type, payload })\n\nexport default createAction\n","import createAction from '../util/createAction'\n\nexport const SCHEDULE_AD_START = 'SCHEDULE_AD_START'\nexport const START_AD = 'START_AD'\nexport const REQUEST_AD_MUTED = 'REQUEST_AD_MUTED'\nexport const REQUEST_AD_PAUSED = 'REQUEST_AD_PAUSED'\nexport const REQUEST_AD_FULLSCREEN = 'REQUEST_AD_FULLSCREEN'\nexport const REQUEST_AD_SKIP = 'REQUEST_AD_SKIP'\nexport const SET_AD_ACTIVE = 'SET_AD_ACTIVE'\nexport const SET_AD_PAUSED = 'SET_AD_PAUSED'\nexport const SET_AD_MUTED = 'SET_AD_MUTED'\nexport const SET_AD_FULLSCREEN = 'SET_AD_FULLSCREEN'\nexport const AD_BUFFER_START = 'AD_BUFFER_START'\nexport const AD_BUFFER_FINISH = 'AD_BUFFER_FINISH'\nexport const AD_VOLUME_CHANGE = 'AD_VOLUME_CHANGE'\nexport const AD_STOPPED = 'AD_STOPPED'\n\nexport const scheduleAdStart = delayed =>\n  createAction(SCHEDULE_AD_START, {\n    delayed\n  })\n\nexport const startAd = delayed =>\n  createAction(START_AD, {\n    delayed\n  })\n\nexport const requestAdMuted = muted =>\n  createAction(REQUEST_AD_MUTED, {\n    muted\n  })\n\nexport const requestAdFullscreen = fullscreen =>\n  createAction(REQUEST_AD_FULLSCREEN, {\n    fullscreen\n  })\n\nexport const requestAdPaused = paused =>\n  createAction(REQUEST_AD_PAUSED, {\n    paused\n  })\n\nexport const requestAdSkip = () => createAction(REQUEST_AD_SKIP)\n\nexport const setAdActive = active =>\n  createAction(SET_AD_ACTIVE, {\n    active\n  })\n\nexport const setAdMuted = muted =>\n  createAction(SET_AD_MUTED, {\n    muted\n  })\n\nexport const setAdFullscreen = fullscreen =>\n  createAction(SET_AD_FULLSCREEN, {\n    fullscreen\n  })\n\nexport const setAdPaused = paused =>\n  createAction(SET_AD_PAUSED, {\n    paused\n  })\n\nexport const adBufferStart = () => createAction(AD_BUFFER_START)\n\nexport const adBufferFinish = () => createAction(AD_BUFFER_FINISH)\n\nexport const adVolumeChange = () => createAction(AD_VOLUME_CHANGE)\n\nexport const adStopped = (errorType = null, message = null) =>\n  createAction(\n    AD_STOPPED,\n    errorType == null\n      ? null\n      : {\n          errorType,\n          message\n        }\n  )\n","import createAction from '../util/createAction'\n\nexport const SET_CONFIG = 'SET_CONFIG'\n\nexport const setConfig = config => createAction(SET_CONFIG, config)\n","import createAction from '../util/createAction'\n\nexport const START_TEST = 'START_TEST'\nexport const END_TEST = 'END_TEST'\n\nexport const startTest = omAccessMode =>\n  createAction(START_TEST, {\n    omAccessMode\n  })\n\nexport const endTest = () => createAction(END_TEST)\n","import createAction from '../util/createAction'\n\nexport const VAST_TRACKER = 'VAST_TRACKER'\n\nexport const vastTrackerFired = (type, uri) =>\n  createAction(VAST_TRACKER, { type, uri })\n","import createAction from '../util/createAction'\n\nexport const VAST_WARNING = 'VAST_WARNING'\nexport const LOAD_VAST = 'LOAD_VAST'\nexport const VAST_LOADED = 'VAST_LOADED'\nexport const VAST_LOAD_FAILED = 'VAST_LOAD_FAILED'\nexport const UNSUPPORTED_MEDIA_FILES = 'UNSUPPORTED_MEDIA_FILES'\nexport const SET_MEDIA_FILE = 'SET_MEDIA_FILE'\nexport const VAST_EVENT = 'VAST_EVENT'\n\nexport const vastWarning = (message, url) =>\n  createAction(VAST_WARNING, {\n    message,\n    url\n  })\n\nexport const loadVast = () => createAction(LOAD_VAST)\n\nexport const vastLoaded = (\n  chain,\n  inLine,\n  linear,\n  trackingEvents,\n  verifications\n) =>\n  createAction(VAST_LOADED, {\n    chain,\n    inLine,\n    linear,\n    trackingEvents,\n    verifications\n  })\n\nexport const vastLoadFailed = error =>\n  createAction(VAST_LOAD_FAILED, {\n    error\n  })\n\nexport const unsupportedMediaFiles = () => createAction(UNSUPPORTED_MEDIA_FILES)\n\nexport const setMediaFile = (url, apiFramework, adParameters) =>\n  createAction(SET_MEDIA_FILE, {\n    url,\n    apiFramework,\n    adParameters\n  })\n\nexport const vastEvent = type =>\n  createAction(VAST_EVENT, {\n    type\n  })\n","import createAction from '../util/createAction'\n\nexport const VERIFICATION_READY = 'VERIFICATION_READY'\nexport const VERIFICATION_SESSION_FINISHED = 'VERIFICATION_SESSION_FINISHED'\nexport const VERIFICATION_EVENT = 'VERIFICATION_EVENT'\nexport const VERIFICATION_ERROR_EVENT = 'VERIFICATION_ERROR_EVENT'\n\nexport const verificationReady = enabled =>\n  createAction(VERIFICATION_READY, {\n    enabled\n  })\n\nexport const verificationSessionFinished = () =>\n  createAction(VERIFICATION_SESSION_FINISHED)\n\nexport const verificationEvent = type =>\n  createAction(VERIFICATION_EVENT, {\n    type\n  })\n\nexport const verificationErrorEvent = (errorType, message) =>\n  createAction(VERIFICATION_ERROR_EVENT, {\n    errorType,\n    message\n  })\n","import createAction from '../util/createAction'\n\nexport const VIDEO_WARNING = 'VIDEO_WARNING'\nexport const REQUEST_VIDEO_ELEMENT_UPDATE = 'REQUEST_VIDEO_ELEMENT_UPDATE'\nexport const SET_VIDEO_ELEMENT = 'SET_VIDEO_ELEMENT'\nexport const UNSET_VIDEO_ELEMENT = 'SET_VIDEO_ELEMENT'\nexport const SET_VIDEO_SRC = 'SET_VIDEO_SRC'\nexport const SET_VIDEO_PAUSED = 'SET_VIDEO_PAUSED'\nexport const SET_VIDEO_MUTED = 'SET_VIDEO_MUTED'\nexport const SET_VIDEO_PROPERTIES = 'SET_VIDEO_PROPERTIES'\nexport const VIDEO_PLAY_PROMISE = 'VIDEO_PLAY_PROMISE'\nexport const VIDEO_PLAY_NO_PROMISE = 'VIDEO_PLAY_NO_PROMISE'\nexport const VIDEO_PLAY_PROMISE_FULFILLED = 'VIDEO_PLAY_PROMISE_FULFILLED'\nexport const VIDEO_PLAY_PROMISE_REJECTED = 'VIDEO_PLAY_PROMISE_REJECTED'\nexport const VIDEO_EVENT = 'VIDEO_EVENT'\n\nexport const videoWarning = message =>\n  createAction(VIDEO_WARNING, {\n    message\n  })\n\nexport const requestVideoElementUpdate = () =>\n  createAction(REQUEST_VIDEO_ELEMENT_UPDATE)\n\nexport const setVideoElement = () => createAction(SET_VIDEO_ELEMENT)\n\nexport const unsetVideoElement = () => createAction(UNSET_VIDEO_ELEMENT)\n\nexport const setVideoSrc = src =>\n  createAction(SET_VIDEO_SRC, {\n    src\n  })\n\nexport const setVideoPaused = paused =>\n  createAction(SET_VIDEO_PAUSED, {\n    paused\n  })\n\nexport const setVideoMuted = muted =>\n  createAction(SET_VIDEO_MUTED, {\n    muted\n  })\n\nexport const setVideoProperties = properties =>\n  createAction(SET_VIDEO_PROPERTIES, {\n    properties\n  })\n\nexport const videoPlayPromise = () => createAction(VIDEO_PLAY_PROMISE)\n\nexport const videoPlayNoPromise = () => createAction(VIDEO_PLAY_NO_PROMISE)\n\nexport const videoPlayPromiseFulfilled = () =>\n  createAction(VIDEO_PLAY_PROMISE_FULFILLED)\n\nexport const videoPlayPromiseRejected = error =>\n  createAction(VIDEO_PLAY_PROMISE_REJECTED, {\n    error\n  })\n\nexport const videoEvent = type =>\n  createAction(VIDEO_EVENT, {\n    type\n  })\n","import createAction from '../util/createAction'\n\nexport const REQUEST_VPAID_DOM_UPDATE = 'REQUEST_VPAID_DOM_UPDATE'\nexport const SET_VPAID_DOM = 'SET_VPAID_DOM'\nexport const UNSET_VPAID_DOM = 'UNSET_VPAID_DOM'\nexport const VPAID_WARNING = 'VPAID_WARNING'\nexport const VPAID_ERROR = 'VPAID_ERROR'\nexport const LOAD_VPAID = 'LOAD_VPAID'\nexport const VPAID_AD_OBTAINED = 'VPAID_AD_OBTAINED'\nexport const VPAID_HANDSHAKE_SUCCESSFUL = 'VPAID_HANDSHAKE_SUCCESSFUL'\nexport const START_VPAID_AD = 'START_VPAID_AD'\nexport const VPAID_EVENT = 'VPAID_EVENT'\nexport const SET_VPAID_PROPERTIES = 'SET_VPAID_PROPERTIES'\nexport const CALL_VPAID_FUNCTION = 'CALL_VPAID_FUNCTION'\nexport const CALLING_VPAID_FUNCTION = 'CALLING_VPAID_FUNCTION'\nexport const VPAID_LOADED = 'VPAID_LOADED'\nexport const VPAID_LOAD_FAILED = 'VPAID_LOAD_FAILED'\n\nexport const requestVpaidDomUpdate = () =>\n  createAction(REQUEST_VPAID_DOM_UPDATE)\n\nexport const setVpaidDom = () => createAction(SET_VPAID_DOM)\n\nexport const unsetVpaidDom = () => createAction(UNSET_VPAID_DOM)\n\nexport const vpaidWarning = message =>\n  createAction(VPAID_WARNING, {\n    message\n  })\n\nexport const vpaidError = (message, cause) =>\n  createAction(VPAID_ERROR, {\n    message,\n    cause\n  })\n\nexport const loadVpaid = url =>\n  createAction(LOAD_VPAID, {\n    url\n  })\n\nexport const vpaidLoaded = () => createAction(VPAID_LOADED)\n\nexport const vpaidLoadFailed = error =>\n  createAction(VPAID_LOAD_FAILED, {\n    error\n  })\n\nexport const vpaidAdObtained = () => createAction(VPAID_AD_OBTAINED)\n\nexport const callVpaidFunction = (name, args = []) =>\n  createAction(CALL_VPAID_FUNCTION, {\n    name,\n    args\n  })\n\nexport const callingVpaidFunction = (name, args = []) =>\n  createAction(CALLING_VPAID_FUNCTION, {\n    name,\n    args\n  })\n\nexport const vpaidHandshakeSuccessful = response =>\n  createAction(VPAID_HANDSHAKE_SUCCESSFUL, {\n    response\n  })\n\nexport const startVpaidAd = () => createAction(START_VPAID_AD)\n\nexport const vpaidEvent = (name, data) =>\n  createAction(VPAID_EVENT, {\n    name,\n    data\n  })\n\nexport const setVpaidProperties = properties =>\n  createAction(SET_VPAID_PROPERTIES, {\n    properties\n  })\n","const { protocol, host } = window.location\n\nexport const APP_NAME = process.env.REACT_APP_NAME\nexport const APP_VENDOR = process.env.REACT_APP_VENDOR\nexport const APP_VERSION = process.env.REACT_APP_VERSION\nexport const APP_BRANCH = process.env.REACT_APP_BRANCH\nexport const APP_BUILD_DATE = process.env.REACT_APP_BUILD_DATE\nexport const APP_URL = `${protocol}//${host}`\n\nexport const DEFAULT_VAST_URL = `${APP_URL}/fixtures/vast/vast3.xml`\n\nexport const PRELOAD_SIMULATION_TIME = 5000\nexport const SCRIPT_LOAD_TIMEOUT = 30000\nexport const SESSION_START_TIMEOUT = 5000\nexport const VPAID_PROPERTIES_UPDATE_INTERVAL = 250\n","import qs from 'qs'\n\nimport { DEFAULT_VAST_URL } from './settings'\n\nconst ConfigSchema = {\n  vastUrl: { type: 'string', default: DEFAULT_VAST_URL },\n  audioUnmuted: { type: 'boolean', default: false },\n  startDelayed: { type: 'boolean', default: false },\n  vpaidEnabled: { type: 'boolean', default: true },\n  vpaidPropertiesAllowedBeforeAdLoaded: { type: 'boolean', default: true },\n  omAccessMode: { type: 'string', default: 'full' }\n}\n\nconst isUnset = value => value == null || value === false || value === ''\n\nconst isBooleanKey = key =>\n  ConfigSchema[key] != null && ConfigSchema[key].type === 'boolean'\n\nconst normalize = config =>\n  Object.entries(config).reduce(\n    (acc, [key, value]) =>\n      isUnset(value)\n        ? acc\n        : {\n            ...acc,\n            [key]: isBooleanKey(key) ? '' + value === 'true' : '' + value\n          },\n    {}\n  )\n\nconst createDefaultConfig = () =>\n  Object.entries(ConfigSchema).reduce(\n    (acc, [key, { default: value }]) => ({ ...acc, [key]: value }),\n    {}\n  )\n\nconst parseConfig = str => (str === '' ? null : normalize(qs.parse(str)))\n\nconst stringifyConfig = config =>\n  config == null ? '' : qs.stringify(normalize(config))\n\nconst configsEqual = (a, b) => stringifyConfig(a) === stringifyConfig(b)\n\nexport {\n  ConfigSchema,\n  configsEqual,\n  createDefaultConfig,\n  parseConfig,\n  stringifyConfig\n}\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport { setConfig } from '../actions'\nimport { configsEqual, parseConfig } from '../config'\n\nclass ApplyConfig extends React.Component {\n  componentDidMount () {\n    const { location, config, onApplyConfig } = this.props\n    const newConfig = parseConfig(location.search.substr(1))\n    if ((newConfig != null) & !configsEqual(config, newConfig)) {\n      onApplyConfig(newConfig)\n    }\n  }\n\n  render () {\n    return null\n  }\n}\n\nconst mapStateToProps = ({ config }) => ({ config })\n\nconst mapDispatchToProps = dispatch => ({\n  onApplyConfig: config => {\n    dispatch(setConfig(config))\n  }\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ApplyConfig)\n","import React from 'react'\nimport Toggle from 'react-toggle'\n\nlet counter = 0\n\nconst Checkbox = React.memo(({ label, tooltip, defaultValue, onChange }) => {\n  const id = 'checkbox-' + ++counter\n  return (\n    <div className=\"form-group form-group-checkbox\">\n      <label htmlFor={id} title={tooltip}>\n        {label}\n      </label>\n      <Toggle\n        id={id}\n        icons={false}\n        defaultChecked={defaultValue}\n        onChange={evt => onChange(evt.target.checked)}\n      />\n    </div>\n  )\n})\n\nexport default Checkbox\n","import React from 'react'\n\nconst Fieldset = ({ legend, children, className }) => (\n  <fieldset className={className}>\n    <legend>{legend}</legend>\n    {children}\n  </fieldset>\n)\n\nexport default Fieldset\n","import React from 'react'\nimport FontAwesome from 'react-fontawesome'\nimport { Link } from 'react-router-dom'\n\nimport { APP_NAME } from '../settings'\n\nconst Header = React.memo(({ onActivateCopyLink, onActivateAbout }) => (\n  <header>\n    <h1>\n      <span className=\"before\" />\n      <span className=\"title\">{APP_NAME}</span>\n    </h1>\n    <nav>\n      <ul>\n        <li>\n          <Link to=\"/share\" title=\"Share Link\">\n            <FontAwesome name=\"share-alt\" />\n          </Link>\n        </li>\n        <li>\n          <a\n            href=\"https://github.com/InteractiveAdvertisingBureau/VAST-Tester\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            title=\"Fork on GitHub\"\n          >\n            <FontAwesome name=\"github-alt\" />\n          </a>\n        </li>\n        <li>\n          <Link to=\"/about\" title=\"About\">\n            <FontAwesome name=\"info\" />\n          </Link>\n        </li>\n      </ul>\n    </nav>\n  </header>\n))\n\nexport default Header\n","import React from 'react'\n\nconst Switch = React.memo(\n  ({ label, tooltip, options, defaultValue, onChange }) => {\n    return (\n      <div className=\"form-group form-group-switch\">\n        <label title={tooltip}>{label}</label>\n        <div className=\"switch-options\">\n          {[...Object.entries(options)].map(([name, label], idx) => (\n            <div\n              key={idx}\n              className={\n                'switch-option' + (name === defaultValue ? ' active' : '')\n              }\n              onClick={() => onChange(name)}\n            >\n              {label}\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n)\n\nexport default Switch\n","import React from 'react'\nimport TextArea from 'react-textarea-autosize'\n\nlet counter = 0\n\nconst TextInput = React.memo(({ label, defaultValue, onChange }) => {\n  const id = 'text-input-' + ++counter\n  return (\n    <div className=\"form-group form-group-input\">\n      {label != null ? <label htmlFor={id}>{label}</label> : null}\n      <TextArea\n        id={id}\n        defaultValue={defaultValue}\n        className=\"expanding\"\n        minRows={1}\n        maxRows={10}\n        onChange={evt => onChange(evt.target.value)}\n      />\n    </div>\n  )\n})\n\nexport default TextInput\n","export const VERIFICATION_EVENT_TYPES = [\n  'loaded',\n  'start',\n  'impression',\n  'firstQuartile',\n  'midpoint',\n  'thirdQuartile',\n  'complete',\n  'error'\n]\n\nexport const VERIFICATION_ACCESS_MODES = ['limited', 'creative', 'full']\n","const mapObject = (keys, value) => {\n  const obj = {}\n  for (const key of keys) {\n    obj[key] = typeof value === 'function' ? value(key) : value\n  }\n  return obj\n}\n\nexport default mapObject\n","const msToString = ms =>\n  ms < 1000 ? ms + ' ms' : ms === 1000 ? '1 second' : ms / 1000 + ' seconds'\n\nexport default msToString\n","import React from 'react'\nimport FontAwesome from 'react-fontawesome'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport { upperCaseFirst } from 'upper-case-first'\n\nimport { setConfig } from '../actions'\nimport Checkbox from '../components/Checkbox'\nimport Fieldset from '../components/Fieldset'\nimport Header from '../components/Header'\nimport Switch from '../components/Switch'\nimport TextInput from '../components/TextInput'\nimport { createDefaultConfig, parseConfig, stringifyConfig } from '../config'\nimport { VERIFICATION_ACCESS_MODES } from '../constants/verification'\nimport { PRELOAD_SIMULATION_TIME } from '../settings'\nimport mapObject from '../util/mapObject'\nimport msToString from '../util/msToString'\n\nconst { atob, btoa } = window\n\nconst VERIFICATION_ACCESS_MODE_OPTIONS = mapObject(\n  VERIFICATION_ACCESS_MODES,\n  upperCaseFirst\n)\n\nconst reBase64DataUri = /^data:[^,;]+;base64,(.*)/\n\nconst fromDataUri = uri => {\n  const match = reBase64DataUri.exec(uri)\n  if (match != null) {\n    try {\n      uri = atob(match[1])\n    } catch (_) {}\n  }\n  return uri\n}\n\nconst toDataUri = value =>\n  value.trim().charAt(0) === '<' ? 'data:text/xml;base64,' + btoa(value) : value\n\nclass Config extends React.Component {\n  constructor (props) {\n    super(props)\n    const { location, config, onResetConfig } = props\n    if (config != null) {\n      onResetConfig()\n    }\n    this.state = parseConfig(location.search.substr(1)) || createDefaultConfig()\n  }\n\n  render () {\n    return (\n      <main className=\"config\">\n        <Header />\n        <div className=\"contents\">\n          <form\n            onSubmit={event => {\n              event.preventDefault()\n              this._runButton.click()\n            }}\n          >\n            <Fieldset legend=\"VAST (URL or XML)\">\n              <TextInput\n                defaultValue={fromDataUri(this.state.vastUrl)}\n                onChange={this._onVastUrlChange.bind(this)}\n              />\n            </Fieldset>\n            <Fieldset legend=\"Video Player Behavior\">\n              <Checkbox\n                label=\"Enable audio by default\"\n                tooltip=\"Allows the ad to play audio without user interaction\"\n                defaultValue={this.state.audioUnmuted}\n                onChange={this._onChange('audioUnmuted')}\n              />\n              <Checkbox\n                label=\"Simulate creative preloading\"\n                tooltip={\n                  'Delays the start of the ad by ' +\n                  msToString(PRELOAD_SIMULATION_TIME) +\n                  ' (useful to diagnose premature events)'\n                }\n                defaultValue={this.state.startDelayed}\n                onChange={this._onChange('startDelayed')}\n              />\n            </Fieldset>\n            <Fieldset legend=\"VPAID Creative\">\n              <Checkbox\n                label=\"Allow VPAID media files\"\n                tooltip=\"Prefers interactive media files over standard video if available\"\n                defaultValue={this.state.vpaidEnabled}\n                onChange={this._onChange('vpaidEnabled')}\n              />\n              <Checkbox\n                label=\"Get VPAID properties before AdLoaded\"\n                tooltip=\"Aggressively requests metadata from VPAID units (incompatible with some ads)\"\n                defaultValue={this.state.vpaidPropertiesAllowedBeforeAdLoaded}\n                onChange={this._onChange(\n                  'vpaidPropertiesAllowedBeforeAdLoaded'\n                )}\n              />\n            </Fieldset>\n            <Fieldset legend=\"Open Measurement\">\n              <Switch\n                label=\"Verification access mode\"\n                tooltip=\"Determines access permissions for verification scripts\"\n                options={VERIFICATION_ACCESS_MODE_OPTIONS}\n                defaultValue={this.state.omAccessMode}\n                onChange={this._onChange('omAccessMode')}\n              />\n            </Fieldset>\n          </form>\n        </div>\n        <div className=\"actions\">\n          <nav>\n            <ul>\n              <li>\n                <Link\n                  to={{ pathname: '/run', search: stringifyConfig(this.state) }}\n                  innerRef={ref => {\n                    this._runButton = ref\n                  }}\n                >\n                  Run Test <FontAwesome name=\"arrow-right\" />\n                </Link>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </main>\n    )\n  }\n\n  _onChange (key) {\n    return value => {\n      this.setState({\n        ...this.state,\n        [key]: value\n      })\n    }\n  }\n\n  _onVastUrlChange (value) {\n    this.setState({\n      ...this.state,\n      vastUrl: toDataUri(value)\n    })\n  }\n}\n\nconst mapStateToProps = ({ config }) => ({ config })\n\nconst mapDispatchToProps = dispatch => ({\n  onResetConfig: () => {\n    dispatch(setConfig(null))\n  }\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Config)\n","import toJSON from './toJSON'\n\nconst stringify = obj =>\n  typeof obj === 'string' ? obj : JSON.stringify(toJSON(obj), null, 2)\n\nexport default stringify\n","import React from 'react'\n\nconst KeyValue = React.memo(({ data, sort, nowrap, serializer }) => {\n  const keys = Object.keys(data)\n  if (sort) {\n    keys.sort()\n  }\n  const wrapClass = nowrap ? 'kv-nowrap' : 'kv-wrap'\n  return (\n    <dl className=\"kv\">\n      {keys.map(key => {\n        const cssKey = key.replace(/ /g, ' ')\n        const value = data[key]\n        const type = typeof value\n        const valueStr = serializer != null ? serializer(value) : '' + value\n        const title = `${key}: ${valueStr}`\n        return (\n          <React.Fragment key={key}>\n            <dt\n              className={`kv-${cssKey}-key kv-type-${type}-key ${wrapClass}`}\n              title={title}\n              data-key={key}\n              data-value={valueStr}\n            >\n              <span>{key}</span>\n            </dt>\n            <dd\n              className={`kv-${cssKey}-value kv-type-${type}-value ${wrapClass}`}\n              title={title}\n              data-key={key}\n              data-value={valueStr}\n            >\n              <span>{valueStr}</span>\n            </dd>\n          </React.Fragment>\n        )\n      })}\n    </dl>\n  )\n})\n\nexport default KeyValue\n","import React from 'react'\n\nconst Placeholder = ({ className, children } = { className: '' }) => (\n  <div className={`placeholder ${className}`}>{children}</div>\n)\n\nexport default Placeholder\n","import { format } from 'date-fns'\nimport React from 'react'\nimport FontAwesome from 'react-fontawesome'\n\nimport msToString from '../util/msToString'\nimport stringify from '../util/stringify'\nimport KeyValue from './KeyValue'\nimport Placeholder from './Placeholder'\n\nconst LEVEL_TO_ICON = {\n  info: 'info',\n  warn: 'exclamation-triangle',\n  error: 'times'\n}\n\nclass LogItem extends React.PureComponent {\n  render () {\n    const {\n      timestamp,\n      timeDelta,\n      timeTotal,\n      level,\n      category,\n      text,\n      metadata\n    } = this.props\n    const classNames = `level-${level} category-${category.toLowerCase()}`\n    const timeTooltip =\n      timeDelta >= 0\n        ? `Elapsed: ${msToString(timeDelta)} since previous, ${msToString(\n            timeTotal\n          )} total`\n        : null\n    const textWithMetadata =\n      metadata == null\n        ? (\n            text\n          )\n        : (\n        <>\n          {text}\n          <div className=\"metadata\">\n            <KeyValue data={metadata} serializer={stringify} />\n          </div>\n        </>\n          )\n    return (\n      <>\n        <tr className={`${classNames} first`}>\n          <td className=\"time\" title={timeTooltip}>\n            {format(timestamp, 'HH:mm:ss.SSS')}\n          </td>\n          <td className=\"level\">\n            <span className=\"icon\">\n              <FontAwesome name={LEVEL_TO_ICON[level]} />\n            </span>\n            <span className=\"label\">{level}</span>\n          </td>\n          <td className=\"category\">{category}</td>\n          <td className=\"text\">{textWithMetadata}</td>\n        </tr>\n        <tr className={`${classNames} second`}>\n          <td className=\"category\">{category}</td>\n          <td className=\"text\" colSpan=\"3\">\n            {textWithMetadata}\n          </td>\n        </tr>\n      </>\n    )\n  }\n}\n\nclass Log extends React.PureComponent {\n  constructor (props) {\n    super(props)\n    this._containerRef = React.createRef()\n  }\n\n  getSnapshotBeforeUpdate (prevProps) {\n    if (prevProps.events.length === this.props.events.length) {\n      return false\n    }\n    const container = this._containerRef.current\n    const parent = container.parentNode\n    return parent.scrollTop + parent.clientHeight === parent.scrollHeight\n  }\n\n  componentDidUpdate (prevProps, prevState, snapshot) {\n    if (snapshot) {\n      const container = this._containerRef.current\n      container.querySelector('.last').scrollIntoView()\n    }\n  }\n\n  render () {\n    const { events } = this.props\n    if (events.length === 0) {\n      return <Placeholder>No log items to show</Placeholder>\n    }\n    const startTime = events[0].timestamp\n    return (\n      <div className=\"log\" ref={this._containerRef}>\n        <table>\n          <tbody>\n            {events.map(({ timestamp, level, category, text, metadata }, i) => (\n              <LogItem\n                key={i}\n                timestamp={timestamp}\n                timeDelta={i > 0 ? timestamp - events[i - 1].timestamp : -1}\n                timeTotal={timestamp - startTime}\n                level={level}\n                category={category}\n                text={text}\n                metadata={metadata}\n              />\n            ))}\n            <tr className=\"last\" />\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\n\nexport default Log\n","import { connect } from 'react-redux'\n\nimport Log from '../components/Log'\n\nconst mapStateToProps = ({ log: { events } }) => ({ events })\n\nexport default connect(mapStateToProps)(Log)\n","import React from 'react'\nimport ReactCollapsible from 'react-collapsible'\n\nconst Collapsible = props => (\n  <ReactCollapsible {...props} open transitionTime={100} />\n)\n\nexport default Collapsible\n","import theme from 'base16/src/google'\n\nexport default theme\n","import React from 'react'\nimport ReactJSONTree from 'react-json-tree'\n\nimport baseTheme from '../style/theme'\n\nconst theme = {\n  extend: baseTheme,\n  tree: {\n    marginTop: 0,\n    marginBottom: 0\n  }\n}\n\nconst valueRenderer = (rendered, raw) =>\n  typeof raw === 'string'\n    ? (\n        raw === ''\n          ? (\n      <span className=\"empty\">(empty)</span>\n            )\n          : (\n              raw\n            )\n      )\n    : (\n        rendered\n      )\n\nconst JSONTree = props => (\n  <ReactJSONTree {...props} theme={theme} valueRenderer={valueRenderer} />\n)\n\nexport default JSONTree\n","const replaceKey = (obj, from, to, seen = []) => {\n  if (obj == null || typeof obj !== 'object') {\n    return obj\n  }\n  if (seen.includes(obj)) {\n    return obj\n  }\n  if (Array.isArray(obj)) {\n    const clone = obj.map(el => replaceKey(el, from, to, seen))\n    seen.push(clone)\n    return clone\n  }\n  const clone = Object.keys(obj).reduce(\n    (acc, key) => ({\n      ...acc,\n      [key === from ? to : key]: replaceKey(obj[key], from, to, seen)\n    }),\n    {}\n  )\n  seen.push(clone)\n  return clone\n}\n\nexport default replaceKey\n","const startsWith = (str, prefix) => str.substr(0, prefix.length) === prefix\n\nexport default startsWith\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport Collapsible from '../components/Collapsible'\nimport JSONTree from '../components/JSONTree'\nimport KeyValue from '../components/KeyValue'\nimport replaceKey from '../util/replaceKey'\nimport startsWith from '../util/startsWith'\n\nconst kType = Symbol('type')\n\nconst renderItem = (type, data, itemType, itemString) => (\n  <span>\n    {data != null && data[kType] != null\n      ? data[kType]\n      : type === 'Array'\n        ? itemString\n        : itemType}\n  </span>\n)\n\nconst VastTagOutline = ({ vast }) => (\n  <div className=\"vast\">\n    <JSONTree data={vast} getItemString={renderItem} />\n  </div>\n)\n\nconst VastDetails = React.memo(({ eventCounts, chain, mediaFileUrl }) => {\n  const { uri } = chain[0]\n  return (\n    <div className=\"vast-details\">\n      {!startsWith(uri, 'data:') && (\n        <Collapsible trigger=\"VAST Tag\">\n          <div className=\"vast-info\">\n            <KeyValue\n              data={{\n                URL: uri\n              }}\n            />\n          </div>\n        </Collapsible>\n      )}\n      <Collapsible trigger=\"VAST Events\">\n        <div className=\"events\">\n          <KeyValue data={eventCounts} />\n        </div>\n      </Collapsible>\n      <Collapsible trigger=\"VAST Chain\">\n        <div className=\"vast-chain\">\n          {chain.map((vast, i) => (\n            <VastTagOutline vast={vast} key={i} />\n          ))}\n        </div>\n      </Collapsible>\n    </div>\n  )\n})\n\nconst mapStateToProps = ({ vast: { eventCounts, chain, mediaFile } }) => ({\n  eventCounts,\n  chain: replaceKey(chain, '$type', kType)\n})\n\nexport default connect(mapStateToProps)(VastDetails)\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport Collapsible from '../components/Collapsible'\nimport KeyValue from '../components/KeyValue'\n\nconst VerificationDetails = React.memo(\n  ({ accessMode, scripts, eventCounts }) => (\n    <div className=\"verification-details\">\n      <Collapsible trigger=\"Open Measurement Events\">\n        <div className=\"events\">\n          <KeyValue data={eventCounts} />\n        </div>\n      </Collapsible>\n      {scripts.map(({ uri, vendor, verificationParameters }, i) => (\n        <Collapsible trigger={`Open Measurement Script #${i + 1}`} key={i}>\n          <div className=\"properties\">\n            <KeyValue\n              data={{\n                Vendor: vendor,\n                URL: uri,\n                Parameters:\n                  verificationParameters != null\n                    ? verificationParameters\n                    : '(none)',\n                'Access Mode': accessMode\n              }}\n            />\n          </div>\n        </Collapsible>\n      ))}\n    </div>\n  )\n)\n\nconst mapStateToProps = ({\n  verification: { accessMode, scripts, eventCounts }\n}) => ({\n  accessMode,\n  scripts,\n  eventCounts\n})\n\nexport default connect(mapStateToProps)(VerificationDetails)\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport Collapsible from '../components/Collapsible'\nimport KeyValue from '../components/KeyValue'\n\nconst stringifiers = {\n  TimeRanges: obj =>\n    'TimeRanges[' +\n    (obj.data.length > 0\n      ? ' ' +\n        obj.data\n          .map(({ start, end }) => '(' + start + ', ' + end + ')')\n          .join(', ') +\n        ' '\n      : '0') +\n    ']',\n  TextTrackList: obj => `TextTrackList[${obj.data.length}]`\n}\n\nconst stringifyProperties = properties => {\n  const out = {}\n  for (const name of Object.keys(properties)) {\n    const obj = properties[name]\n    out[name] =\n      obj != null && obj.$type != null && stringifiers[obj.$type] != null\n        ? stringifiers[obj.$type](obj)\n        : '' + obj\n  }\n  return out\n}\n\nconst VideoDetails = React.memo(({ eventCounts, properties }) => (\n  <div className=\"video-details\">\n    <Collapsible trigger=\"Video Events\">\n      <div className=\"events\">\n        <KeyValue data={eventCounts} />\n      </div>\n    </Collapsible>\n    <Collapsible trigger=\"Video Element Properties\">\n      <div className=\"properties\">\n        <KeyValue data={stringifyProperties(properties)} />\n      </div>\n    </Collapsible>\n  </div>\n))\n\nconst mapStateToProps = ({ video }) => video\n\nexport default connect(mapStateToProps)(VideoDetails)\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport Collapsible from '../components/Collapsible'\nimport KeyValue from '../components/KeyValue'\n\nconst VpaidDetails = React.memo(\n  ({ status, url, adParameters, eventCounts, properties }) => (\n    <div className=\"vpaid-details\">\n      <Collapsible trigger=\"VPAID Creative\">\n        <div className=\"vpaid-info\">\n          <KeyValue\n            data={{\n              Status: status,\n              URL: url,\n              Parameters: adParameters != null ? adParameters : '(none)'\n            }}\n          />\n        </div>\n      </Collapsible>\n      <Collapsible trigger=\"VPAID Events\">\n        <div className=\"events\">\n          <KeyValue data={eventCounts} />\n        </div>\n      </Collapsible>\n      <Collapsible trigger=\"VPAID Properties\">\n        <div className=\"properties\">\n          <KeyValue data={properties} />\n        </div>\n      </Collapsible>\n    </div>\n  )\n)\n\nconst mapStateToProps = ({\n  vpaid: { status, eventCounts, properties },\n  vast: {\n    mediaFile: { url },\n    adParameters\n  }\n}) => ({\n  status,\n  url,\n  adParameters,\n  eventCounts,\n  properties\n})\n\nexport default connect(mapStateToProps)(VpaidDetails)\n","import React from 'react'\nimport { Tab, TabList, TabPanel, Tabs } from 'react-tabs'\n\nimport Log from '../containers/Log'\nimport VastDetails from '../containers/VastDetails'\nimport VerificationDetails from '../containers/VerificationDetails'\nimport VideoDetails from '../containers/VideoDetails'\nimport VpaidDetails from '../containers/VpaidDetails'\n\nconst Details = ({ logOnly, vpaidEnabled, verificationEnabled }) => (\n  <div className=\"details\">\n    <Tabs>\n      <TabList>\n        <Tab>Log</Tab>\n        <Tab disabled={logOnly}>VAST</Tab>\n        <Tab disabled={logOnly || !vpaidEnabled}>VPAID</Tab>\n        <Tab disabled={logOnly}>Video</Tab>\n        <Tab disabled={logOnly || !verificationEnabled}>OMID</Tab>\n      </TabList>\n\n      <TabPanel>\n        <Log />\n      </TabPanel>\n      <TabPanel>\n        <VastDetails />\n      </TabPanel>\n      <TabPanel>\n        <VpaidDetails />\n      </TabPanel>\n      <TabPanel>\n        <VideoDetails />\n      </TabPanel>\n      <TabPanel>\n        <VerificationDetails />\n      </TabPanel>\n    </Tabs>\n  </div>\n)\n\nexport default Details\n","export const VIDEO_ELEMENT_ID = 'video-slot'\n\nexport const SLOT_ELEMENT_ID = 'slot'\n\nexport const VPAID_IFRAME_ID = 'vpaid-iframe'\n\nexport const VPAID_IFRAME_HTML = `<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<style>\nhtml, body {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n  overflow: hidden;\n  background: transparent;\n}\n#slot {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n</style>\n</head>\n<body>\n<div id=\"${SLOT_ELEMENT_ID}\"></div>\n</body>\n</html>`\n","import React from 'react'\nimport FontAwesome from 'react-fontawesome'\nimport { connect } from 'react-redux'\n\nimport {\n  requestAdFullscreen,\n  requestAdMuted,\n  requestAdPaused,\n  requestAdSkip,\n  requestVideoElementUpdate,\n  requestVpaidDomUpdate\n} from '../actions'\nimport {\n  VIDEO_ELEMENT_ID,\n  VPAID_IFRAME_HTML,\n  VPAID_IFRAME_ID\n} from '../constants/dom'\n\nconst kLoadedSrc = Symbol('loadedSrc')\n\nconst acceptVideoRef = ({ shared, videoMuted }, callback) => element => {\n  if (element == null) {\n    return\n  }\n  // React only sets the muted property, not the attribute\n  // See https://github.com/facebook/react/issues/6544\n  element.defaultMuted = videoMuted\n  // Load video source if it's not being controlled by a VPAID unit\n  if (\n    !shared &&\n    element[kLoadedSrc] !== element.src &&\n    typeof element.load === 'function'\n  ) {\n    element.load()\n    element[kLoadedSrc] = element.src\n  }\n  // Dispatch\n  callback(element)\n}\n\nconst acceptIframeRef = iframe => {\n  if (iframe == null) {\n    return\n  }\n  const doc = iframe.contentWindow.document\n  doc.open()\n  doc.write(VPAID_IFRAME_HTML)\n  doc.close()\n}\n\nconst VideoPlayer = ({\n  shared,\n  videoSrc,\n  videoMuted,\n  adActive,\n  adPaused,\n  adMuted,\n  adFullscreen,\n  onVideoElementRef,\n  onVpaidIframeLoaded,\n  onSetAdPaused,\n  onSetAdMuted,\n  onSetAdFullscreen,\n  onSkipAd\n}) => (\n  <div className=\"video-player\">\n    <div className=\"video-player-main\">\n      <div className=\"video-player-inner\">\n        <video\n          id={VIDEO_ELEMENT_ID}\n          src={videoSrc}\n          muted={videoMuted}\n          playsInline\n          ref={acceptVideoRef({ shared, videoMuted }, onVideoElementRef)}\n        />\n        {shared\n          ? (\n          <iframe\n            id={VPAID_IFRAME_ID}\n            src=\"about:blank\"\n            className=\"vpaid-host\"\n            title=\"VPAID Host\"\n            ref={acceptIframeRef}\n            onLoad={onVpaidIframeLoaded}\n          />\n            )\n          : null}\n      </div>\n    </div>\n    <div className=\"video-player-controls\">\n      <nav>\n        <ul className=\"ad-controls\">\n          <li>\n            <button\n              title=\"Skip Ad\"\n              onClick={adActive ? onSkipAd : null}\n              className={adActive ? '' : 'disabled'}\n            >\n              <FontAwesome name=\"close\" />\n            </button>\n          </li>\n        </ul>\n        <ul className=\"playback-controls\">\n          <li>\n            <button\n              title={adPaused ? 'Resume Ad' : 'Pause Ad'}\n              onClick={adActive ? () => onSetAdPaused(!adPaused) : null}\n              className={adActive ? '' : 'disabled'}\n            >\n              <FontAwesome name={adPaused ? 'play' : 'pause'} />\n            </button>\n          </li>\n          <li>\n            <button\n              title={adMuted ? 'Unmute Audio' : 'Mute Audio'}\n              onClick={adActive ? () => onSetAdMuted(!adMuted) : null}\n              className={adActive ? '' : 'disabled'}\n            >\n              <FontAwesome name={adMuted ? 'volume-off' : 'volume-up'} />\n            </button>\n          </li>\n          <li>\n            <button\n              title={adFullscreen ? 'Exit Fullscreen' : 'Enter Fullscreen'}\n              onClick={adActive ? () => onSetAdFullscreen(!adFullscreen) : null}\n              className={adActive ? '' : 'disabled'}\n            >\n              <FontAwesome name={adFullscreen ? 'compress' : 'expand'} />\n            </button>\n          </li>\n        </ul>\n      </nav>\n    </div>\n  </div>\n)\n\nconst mapStateToProps = ({\n  video: { shared, src: videoSrc, muted: videoMuted, paused: videoPaused },\n  ad: {\n    active: adActive,\n    paused: adPaused,\n    muted: adMuted,\n    fullscreen: adFullscreen\n  }\n}) => ({\n  shared,\n  videoSrc,\n  videoPaused,\n  videoMuted,\n  adActive,\n  adPaused,\n  adMuted,\n  adFullscreen\n})\n\nconst mapDispatchToProps = dispatch => ({\n  onVideoElementRef: () => {\n    dispatch(requestVideoElementUpdate())\n  },\n  onVpaidIframeLoaded: () => {\n    dispatch(requestVpaidDomUpdate())\n  },\n  onSetAdPaused: value => {\n    dispatch(requestAdPaused(value))\n  },\n  onSetAdMuted: value => {\n    dispatch(requestAdMuted(value))\n  },\n  onSetAdFullscreen: value => {\n    dispatch(requestAdFullscreen(value))\n  },\n  onSkipAd: () => {\n    dispatch(requestAdSkip())\n  }\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(VideoPlayer)\n","import React from 'react'\nimport FontAwesome from 'react-fontawesome'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\n\nimport Details from '../components/Details'\nimport Header from '../components/Header'\nimport { stringifyConfig } from '../config'\nimport VideoPlayer from './VideoPlayer'\n\nconst Runner = ({\n  config,\n  vastLoaded,\n  mediaFileIsVpaid,\n  hasVerificationScripts\n}) =>\n  config == null\n    ? null\n    : (\n    <main className=\"runner\">\n      <Header />\n      <div className=\"contents\">\n        <VideoPlayer />\n        <Details\n          logOnly={!vastLoaded}\n          vpaidEnabled={mediaFileIsVpaid}\n          verificationEnabled={hasVerificationScripts}\n        />\n      </div>\n      <div className=\"actions\">\n        <nav>\n          <ul>\n            <li>\n              <Link to={{ pathname: '/', search: stringifyConfig(config) }}>\n                <FontAwesome name=\"arrow-left\" /> New Test\n              </Link>\n            </li>\n          </ul>\n        </nav>\n      </div>\n    </main>\n      )\n\nconst mapStateToProps = ({\n  config,\n  vast: { chain, mediaFile, verifications }\n}) => ({\n  config,\n  vastLoaded: chain != null,\n  mediaFileIsVpaid: mediaFile != null && mediaFile.apiFramework === 'VPAID',\n  hasVerificationScripts: verifications != null && verifications.length > 0\n})\n\nexport default connect(mapStateToProps)(Runner)\n","import React from 'react'\nimport FontAwesome from 'react-fontawesome'\nimport { withRouter } from 'react-router'\n\nconst Modal = ({ history, children }) => (\n  <div className=\"modal\">\n    {children}\n    <nav>\n      <ul>\n        <li>\n          <button\n            onClick={() => {\n              if (history.length > 1) {\n                history.goBack()\n              } else {\n                history.push('/')\n              }\n            }}\n          >\n            <FontAwesome name=\"close\" /> Close\n          </button>\n        </li>\n      </ul>\n    </nav>\n  </div>\n)\n\nexport default withRouter(Modal)\n","import { START_TEST } from '../actions'\n\nconst history = []\n\nconst getHistory = () => history\n\nconst historyMiddleware = store => next => action => {\n  if (action.type === START_TEST) {\n    history.length = 0\n  }\n  history.push({\n    ...action,\n    _ts: Date.now()\n  })\n  return next(action)\n}\n\nexport { getHistory }\n\nexport default historyMiddleware\n","import { format } from 'date-fns'\nimport { saveAs } from 'file-saver'\nimport React from 'react'\nimport CopyToClipboard from 'react-copy-to-clipboard'\nimport { connect } from 'react-redux'\n\nimport Modal from '../components/Modal'\nimport { stringifyConfig } from '../config'\nimport { getHistory } from '../middleware/history'\nimport { APP_VERSION } from '../settings'\nimport stringify from '../util/stringify'\n\nconst LOG_MIME_TYPE = 'application/json'\n\nconst getBaseUrl = () => {\n  const { protocol, host, pathname } = window.location\n  return `${protocol}//${host}${pathname}`\n}\n\nconst getLogData = () =>\n  stringify({\n    version: APP_VERSION,\n    history: getHistory()\n  })\n\nconst getLogFileName = () =>\n  'vast-tester-' + format(new Date(), 'yyyy-MM-dd-HH-mm-ss') + '.json'\n\nconst onActivateDownloadLog = () => {\n  const blob = new Blob([getLogData()], { type: LOG_MIME_TYPE })\n  saveAs(blob, getLogFileName())\n}\n\nconst Share = ({ url }) => (\n  <Modal>\n    <div className=\"share\">\n      <div>Link to this page:</div>\n      <div>\n        <textarea readOnly value={url} />\n      </div>\n      <div>\n        <CopyToClipboard text={url}>\n          <button>Copy to Clipboard</button>\n        </CopyToClipboard>\n      </div>\n      <div className=\"spacer\" />\n      <div>Grab a log file for debugging:</div>\n      <div>\n        <button onClick={onActivateDownloadLog}>Download Log</button>\n      </div>\n    </div>\n  </Modal>\n)\n\nconst mapStateToProps = ({ config }) => ({\n  url: getBaseUrl() + (config != null ? '#/run?' + stringifyConfig(config) : '')\n})\n\nexport default connect(mapStateToProps)(Share)\n","import React from 'react'\n\nimport {\n  APP_BRANCH,\n  APP_BUILD_DATE,\n  APP_NAME,\n  APP_VENDOR,\n  APP_VERSION\n} from '../settings'\nimport Modal from './Modal'\n\nconst About = () => (\n  <Modal>\n    <div className=\"about\">\n      <div className=\"title\">\n        {APP_VENDOR} {APP_NAME}\n      </div>\n      <div>\n        Version {APP_VERSION} {APP_BRANCH != null && ` (${APP_BRANCH} branch)`}\n      </div>\n      {APP_BUILD_DATE != null && <div>Built {APP_BUILD_DATE}</div>}\n      <div className=\"spacer\" />\n      <div>Contributed with</div>\n      <div className=\"heart\">\n        <div className=\"heart-inner\" />\n      </div>\n      <div>\n        by the{' '}\n        <a\n          href=\"https://www.doubleverify.com/\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          DoubleVerify\n        </a>{' '}\n        team\n      </div>\n    </div>\n  </Modal>\n)\n\nexport default About\n","import '../style/app.scss'\n\nimport React from 'react'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\n\nimport ApplyConfig from '../containers/ApplyConfig'\nimport Config from '../containers/Config'\nimport Runner from '../containers/Runner'\nimport Share from '../containers/Share'\nimport About from './About'\n\nconst App = () => (\n  <HashRouter>\n    <>\n      <Runner />\n      <Switch>\n        <Route exact path=\"/\" component={Config} />\n        <Route exact path=\"/run\" component={ApplyConfig} />\n        <Route exact path=\"/share\" component={Share} />\n        <Route exact path=\"/about\" component={About} />\n      </Switch>\n    </>\n  </HashRouter>\n)\n\nexport default App\n","import { combineEpics, ofType } from 'redux-observable'\nimport { combineLatest as $combineLatest, of as $of } from 'rxjs'\nimport {\n  delay,\n  distinctUntilChanged,\n  filter,\n  map,\n  mapTo,\n  mergeMap,\n  skip,\n  takeUntil\n} from 'rxjs/operators'\n\nimport {\n  END_TEST,\n  SCHEDULE_AD_START,\n  scheduleAdStart,\n  SET_AD_ACTIVE,\n  SET_AD_MUTED,\n  SET_CONFIG,\n  setAdActive,\n  startAd,\n  VAST_EVENT,\n  vastEvent,\n  VERIFICATION_READY\n} from '../actions'\nimport { PRELOAD_SIMULATION_TIME } from '../settings'\n\nconst scheduleAdStartEpic = action$ =>\n  action$.pipe(\n    ofType(SET_CONFIG),\n    map(({ payload: config }) => config),\n    filter(Boolean),\n    mergeMap(config =>\n      $combineLatest(\n        action$.pipe(\n          ofType(VAST_EVENT),\n          filter(({ payload: { type } }) => type === 'loaded')\n        ),\n        action$.pipe(ofType(VERIFICATION_READY))\n      ).pipe(mapTo(config), takeUntil(action$.pipe(ofType(END_TEST))))\n    ),\n    map(config => scheduleAdStart(config.startDelayed))\n  )\n\nconst adStartEpic = action$ =>\n  action$.pipe(\n    ofType(SCHEDULE_AD_START),\n    mergeMap(({ payload: settings }) => {\n      let result = $of(settings)\n      if (settings.delayed) {\n        result = result.pipe(\n          delay(PRELOAD_SIMULATION_TIME),\n          takeUntil(action$.pipe(ofType(END_TEST)))\n        )\n      }\n      return result\n    }),\n    map(settings => startAd(settings.delayed))\n  )\n\nconst muteUnmuteEpic = action$ =>\n  action$.pipe(\n    ofType(SET_CONFIG),\n    map(({ payload: config }) => config),\n    filter(Boolean),\n    mergeMap(config =>\n      $combineLatest(\n        action$.pipe(ofType(SET_AD_MUTED)),\n        action$.pipe(\n          ofType(SET_AD_ACTIVE),\n          filter(({ payload: { active } }) => active)\n        )\n      ).pipe(\n        map(\n          ([\n            {\n              payload: { muted }\n            }\n          ]) => muted\n        ),\n        distinctUntilChanged(),\n        skip(1),\n        map(muted => vastEvent(muted ? 'mute' : 'unmute')),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst mapVastEventsToAdActive = (vastEvents, active) => action$ =>\n  action$.pipe(\n    ofType(VAST_EVENT),\n    filter(({ payload: { type } }) => vastEvents.indexOf(type) >= 0),\n    mapTo(setAdActive(active))\n  )\n\nexport default combineEpics(\n  scheduleAdStartEpic,\n  adStartEpic,\n  muteUnmuteEpic,\n  mapVastEventsToAdActive(['start'], true),\n  mapVastEventsToAdActive(['complete', 'skip', 'error'], false)\n)\n","import { ofType } from 'redux-observable'\nimport { of as $of } from 'rxjs'\nimport { mergeMap } from 'rxjs/operators'\n\nimport { endTest, SET_CONFIG, startTest } from '../actions'\n\nconst configEpic = action$ =>\n  action$.pipe(\n    ofType(SET_CONFIG),\n    mergeMap(({ payload: config }) => {\n      const actions = [endTest()]\n      if (config != null) {\n        actions.push(startTest(config.omAccessMode))\n      }\n      return $of(...actions)\n    })\n  )\n\nexport default configEpic\n","import { ofType } from 'redux-observable'\nimport { mapTo } from 'rxjs/operators'\n\nimport { loadVast, START_TEST } from '../actions'\n\nconst testEpic = action$ => action$.pipe(ofType(START_TEST), mapTo(loadVast()))\n\nexport default testEpic\n","import { combineEpics, ofType } from 'redux-observable'\nimport { of as $of } from 'rxjs'\nimport { filter, map, mergeMap, withLatestFrom } from 'rxjs/operators'\n\nimport { VAST_EVENT, vastTrackerFired } from '../actions'\n\nconst getVastTrackingUris = (vastEvent, state) => {\n  try {\n    switch (vastEvent) {\n      case 'impression':\n        return state.vast.inLine.impressions.map(it => it.uri)\n      case 'error':\n        return state.vast.inLine.errors.map(it => it.uri)\n      case 'clickThrough':\n        return state.vast.linear.videoClicks.clickTrackings.map(it => it.uri)\n      default:\n        return state.vast.trackingEvents[vastEvent].map(it => it.uri)\n    }\n  } catch (e) {\n    return null\n  }\n}\n\nconst vastTrackingEpic = (action$, state$) =>\n  action$.pipe(\n    ofType(VAST_EVENT),\n    withLatestFrom(state$),\n    map(([{ payload: { type } }, state]) => [\n      type,\n      getVastTrackingUris(type, state)\n    ]),\n    filter(([, uris]) => uris != null && uris.length > 0),\n    mergeMap(([type, uris]) => $of(...uris.map(uri => [type, uri]))),\n    map(([type, uri]) => vastTrackerFired(type, uri))\n  )\n\nexport default combineEpics(vastTrackingEpic)\n","import { serializeError } from 'serialize-error'\n\nimport stringify from './stringify'\n\nconst errorToString = error => {\n  const raw = serializeError(error)\n  return raw == null\n    ? '(unknown error)'\n    : typeof raw === 'string'\n      ? raw\n      : typeof raw === 'object' && raw.message != null\n        ? raw.message\n        : stringify(raw)\n}\n\nexport default errorToString\n","const removeKey = (obj, key) => {\n  if (obj == null) {\n    return\n  }\n  if (Array.isArray(obj)) {\n    for (const entry of obj) {\n      removeKey(entry, key)\n    }\n    return\n  }\n  if (typeof obj === 'object') {\n    delete obj[key]\n    for (const value of Object.values(obj)) {\n      removeKey(value, key)\n    }\n  }\n}\n\nexport default removeKey\n","let vpaidIframe = null\nlet videoElement = null\nlet slotElement = null\n\nconst sharedDom = {\n  get vpaidIframe () {\n    return vpaidIframe\n  },\n\n  set vpaidIframe (el) {\n    vpaidIframe = el\n  },\n\n  get videoElement () {\n    return videoElement\n  },\n\n  set videoElement (el) {\n    videoElement = el\n  },\n\n  get slotElement () {\n    return slotElement\n  },\n\n  set slotElement (el) {\n    slotElement = el\n  }\n}\n\nexport default sharedDom\n","export const children = (element, name) =>\n  Array.prototype.filter.call(\n    element.childNodes,\n    child => child.nodeName === name\n  )\n\nexport const child = (element, name) => children(element, name)[0]\n\nexport const descendant = (element, names) => names.reduce(child, element)\n\nexport const descendants = (element, names) => {\n  names = names.slice()\n  const last = names.pop()\n  const parent = descendant(element, names)\n  return children(parent, last)\n}\n\nexport const text = node => node.textContent.trim()\n","import { VASTLoader } from 'iab-vast-loader/browser'\nimport { flatten } from 'lodash-es'\nimport { combineEpics, ofType } from 'redux-observable'\nimport { from as $from, merge as $merge, of as $of, Subject } from 'rxjs'\nimport { catchError, map, mergeMap, takeUntil } from 'rxjs/operators'\n\nimport {\n  END_TEST,\n  LOAD_VAST,\n  setAdMuted,\n  setMediaFile,\n  setVideoMuted,\n  unsupportedMediaFiles,\n  VAST_LOADED,\n  vastLoaded,\n  vastLoadFailed,\n  vastWarning\n} from '../actions'\nimport errorToString from '../util/errorToString'\nimport removeKey from '../util/removeKey'\nimport sharedDom from '../util/sharedDom'\nimport toJSON from '../util/toJSON'\nimport * as xmlUtil from '../util/xml'\n\nconst warnings$ = new Subject()\n\nconst warn = (message, url) => {\n  warnings$.next(vastWarning(message, url))\n}\n\nconst getAdFromVast = (type, warn) => vast => {\n  if (vast.version >= '4.0') {\n    warn('Support for VAST 4 is incomplete', vast.uri)\n  }\n  if (vast.adPod != null) {\n    warn('Ad pods not supported yet', vast.uri)\n  }\n  const ads = vast.ads.toArray().filter(ad => ad.$type === type)\n  if (ads.length === 0) {\n    throw new Error('VAST does not contain ad buffet')\n  }\n  if (ads.length > 1) {\n    warn(`Multiple ${type} elements in VAST, using first`, vast.uri)\n  }\n  return ads[0]\n}\n\nconst loadVastChain = (vastUrl, warn) =>\n  $from(new VASTLoader(vastUrl, { noSingleAdPods: true }).load()).pipe(\n    map(chain => {\n      const wrapperVasts = chain.slice(0, chain.length - 1)\n      const wrappers = wrapperVasts.map(getAdFromVast('Wrapper', warn))\n      const inLineVast = chain[chain.length - 1]\n      const inLine = getAdFromVast('InLine', warn)(inLineVast)\n      return { chain, wrappers, inLine }\n    })\n  )\n\nconst getLinearFromInLine = (inLine, warn) => {\n  const linearCreatives = inLine.creatives\n    .toArray()\n    .filter(creative => creative.linear != null)\n  if (linearCreatives.length > 1) {\n    warn('Multiple Linear elements in InLine, using first', inLine.uri)\n  }\n  return linearCreatives[0].linear\n}\n\nconst getTrackingEventsFromLinear = linear => {\n  if (linear.trackingEvents == null) {\n    return {}\n  }\n\n  return linear.trackingEvents.types.reduce(\n    (acc, type) => ({\n      ...acc,\n      [type]: linear.trackingEvents.get(type)\n    }),\n    {}\n  )\n}\n\nconst parseVerificationInstance = verification => {\n  const jsResource = verification.javaScriptResources[0]\n  if (jsResource != null) {\n    return {\n      apiFramework: verification.apiFramework,\n      vendor: verification.vendor,\n      verificationParameters: verification.parameters,\n      uri: jsResource.uri\n    }\n  } else {\n    return null\n  }\n}\n\nconst parseVerificationElement = verification => {\n  const omidJsResource = xmlUtil\n    .children(verification, 'JavaScriptResource')\n    .find(resource => resource.getAttribute('apiFramework') === 'omid')\n  if (omidJsResource != null) {\n    const params = xmlUtil.child(verification, 'VerificationParameters')\n    return {\n      apiFramework: omidJsResource.getAttribute('apiFramework'),\n      vendor: verification.getAttribute('vendor'),\n      verificationParameters: params != null ? params.textContent : null,\n      uri: xmlUtil.text(omidJsResource)\n    }\n  } else {\n    return null\n  }\n}\n\nconst selectVerifications = ads =>\n  flatten(\n    ads.map(ad => {\n      const vast4Verifications = ad.verifications\n        .map(parseVerificationInstance)\n        .filter(Boolean)\n      const extVerifications = flatten(\n        ad.extensions\n          .filter(extension => extension.type === 'AdVerifications')\n          .map(extension =>\n            xmlUtil\n              .descendants(extension.xmlElement, [\n                'AdVerifications',\n                'Verification'\n              ])\n              .map(parseVerificationElement)\n              .filter(Boolean)\n          )\n      )\n      return [...vast4Verifications, ...extVerifications]\n    })\n  )\n\nconst xmlToJSON = elem => {\n  const json = toJSON(elem)\n  removeKey(json, 'xmlElement')\n  return json\n}\n\nconst loadAndAnalyzeVastChain = (url, warn) =>\n  loadVastChain(url, warn).pipe(\n    map(({ chain, wrappers, inLine }) => {\n      const linear = getLinearFromInLine(inLine, warn)\n      const trackingEvents = getTrackingEventsFromLinear(linear)\n      const verifications = selectVerifications([...wrappers, inLine])\n      return {\n        chain: xmlToJSON(chain),\n        inLine: xmlToJSON(inLine),\n        linear: xmlToJSON(linear),\n        trackingEvents: xmlToJSON(trackingEvents),\n        verifications\n      }\n    })\n  )\n\nconst selectVideos = (mediaFiles, response, videoElement) =>\n  mediaFiles.filter(\n    mediaFile =>\n      mediaFile.type !== 'video/3gpp' &&\n      videoElement.canPlayType(mediaFile.type) === response\n  )\n\nconst triageMediaFiles = linear => {\n  const vpaidMedia = []\n  const vanillaMedia = []\n  for (const mediaFile of linear.mediaFiles) {\n    if (mediaFile.apiFramework == null) {\n      vanillaMedia.push(mediaFile)\n    } else if (\n      mediaFile.apiFramework === 'VPAID' &&\n      mediaFile.type === 'application/javascript'\n    ) {\n      vpaidMedia.push(mediaFile)\n    }\n  }\n  return [vpaidMedia, vanillaMedia]\n}\n\nconst sortByDimensions = mediaFiles =>\n  mediaFiles.slice().sort((a, b) => a.width - b.width || a.height - b.height)\n\nconst selectByDimensions = (mediaFiles, maxWidth, maxHeight) => {\n  const sorted = sortByDimensions(mediaFiles)\n  let i = 0\n  while (\n    i + 1 < sorted.length &&\n    sorted[i + 1].width <= maxWidth &&\n    sorted[i + 1].height <= maxHeight\n  ) {\n    ++i\n  }\n  return sorted[i]\n}\n\nconst selectMediaFile = (linear, vpaidEnabled) => {\n  const { videoElement } = sharedDom\n  const [vpaidMedia, vanillaMedia] = triageMediaFiles(linear)\n  if (vpaidEnabled && vpaidMedia.length > 0) {\n    return vpaidMedia[0]\n  }\n  const { offsetWidth: maxWidth, offsetHeight: maxHeight } = videoElement\n  const canProbablyPlay = selectVideos(vanillaMedia, 'probably', videoElement)\n  if (canProbablyPlay.length > 0) {\n    return selectByDimensions(canProbablyPlay, maxWidth, maxHeight)\n  }\n  const canMaybePlay = selectVideos(vanillaMedia, 'maybe', videoElement)\n  if (canMaybePlay.length > 0) {\n    return selectByDimensions(canMaybePlay, maxWidth, maxHeight)\n  }\n  return null\n}\n\nconst loadVastEpic = (action$, state$) =>\n  action$.pipe(\n    ofType(LOAD_VAST),\n    mergeMap(() => {\n      const {\n        config: { vastUrl }\n      } = state$.value\n      return $merge(\n        loadAndAnalyzeVastChain(vastUrl, warn).pipe(\n          map(({ chain, inLine, linear, trackingEvents, verifications }) =>\n            vastLoaded(chain, inLine, linear, trackingEvents, verifications)\n          ),\n          catchError(error => $of(vastLoadFailed(errorToString(error))))\n        ),\n        warnings$\n      ).pipe(takeUntil(action$.pipe(ofType(END_TEST))))\n    })\n  )\n\nconst vastLoadedEpic = (action$, state$) =>\n  action$.pipe(\n    ofType(VAST_LOADED),\n    mergeMap(({ payload: { linear } }) => {\n      const {\n        config: { audioUnmuted, vpaidEnabled }\n      } = state$.value\n      const mediaFile = selectMediaFile(linear, vpaidEnabled)\n      const results = []\n      if (mediaFile != null) {\n        results.push(\n          setAdMuted(!audioUnmuted),\n          setVideoMuted(!audioUnmuted),\n          setMediaFile(\n            mediaFile.uri,\n            mediaFile.apiFramework,\n            linear.adParameters\n          )\n        )\n      } else {\n        results.push(unsupportedMediaFiles(), setMediaFile(null, null, null))\n      }\n      return $of(...results)\n    })\n  )\n\nexport default combineEpics(loadVastEpic, vastLoadedEpic)\n","export const VAST_QUARTILE_EVENT_TYPES = [\n  'firstQuartile',\n  'midpoint',\n  'thirdQuartile',\n  'complete'\n]\n\nexport const VAST_EVENT_TYPES = [\n  'loaded',\n  'start',\n  'impression',\n  'creativeView',\n  ...VAST_QUARTILE_EVENT_TYPES,\n  'mute',\n  'unmute',\n  'pause',\n  'resume',\n  'skip',\n  'clickThrough',\n  'error'\n]\n","export const VIDEO_EVENT_TYPES = [\n  'loadstart',\n  'progress',\n  'suspend',\n  'abort',\n  'error',\n  'emptied',\n  'stalled',\n  'loadedmetadata',\n  'loadeddata',\n  'canplay',\n  'canplaythrough',\n  'playing',\n  'waiting',\n  'seeking',\n  'seeked',\n  'ended',\n  'durationchange',\n  'timeupdate',\n  'play',\n  'pause',\n  'ratechange',\n  'resize',\n  'volumechange'\n]\n\nexport const VIDEO_PROPERTY_NAMES = [\n  'error',\n  'src',\n  'srcObject',\n  'currentSrc',\n  'crossOrigin',\n  'networkState',\n  'preload',\n  'buffered',\n  'readyState',\n  'seeking',\n  'currentTime',\n  'duration',\n  'paused',\n  'defaultPlaybackRate',\n  'playbackRate',\n  'played',\n  'seekable',\n  'ended',\n  'autoplay',\n  'loop',\n  'controls',\n  'volume',\n  'muted',\n  'defaultMuted',\n  'audioTracks',\n  'videoTracks',\n  'textTracks',\n  'width',\n  'height',\n  'videoWidth',\n  'videoHeight',\n  'poster'\n]\n","const clamp = (value, min, max) => Math.max(min, Math.min(max, value))\n\nexport default clamp\n","const isThenable = o => o != null && typeof o.then === 'function'\n\nexport default isThenable\n","import { combineEpics, ofType } from 'redux-observable'\nimport {\n  combineLatest as $combineLatest,\n  concat as $concat,\n  EMPTY as EMPTY$,\n  from as $from,\n  Observable,\n  of as $of\n} from 'rxjs'\nimport {\n  catchError,\n  distinct,\n  filter,\n  ignoreElements,\n  map,\n  mapTo,\n  mergeMap,\n  mergeMapTo,\n  skip,\n  take,\n  takeUntil,\n  tap\n} from 'rxjs/operators'\n\nimport {\n  adBufferFinish,\n  adBufferStart,\n  adStopped,\n  adVolumeChange,\n  END_TEST,\n  REQUEST_AD_FULLSCREEN,\n  REQUEST_AD_MUTED,\n  REQUEST_AD_PAUSED,\n  REQUEST_AD_SKIP,\n  REQUEST_VIDEO_ELEMENT_UPDATE,\n  SET_MEDIA_FILE,\n  SET_VIDEO_ELEMENT,\n  SET_VIDEO_PAUSED,\n  SET_VIDEO_PROPERTIES,\n  setAdFullscreen,\n  setAdMuted,\n  setAdPaused,\n  setVideoElement,\n  setVideoMuted,\n  setVideoPaused,\n  setVideoProperties,\n  setVideoSrc,\n  START_AD,\n  unsetVideoElement,\n  VAST_EVENT,\n  vastEvent,\n  VIDEO_EVENT,\n  videoEvent,\n  videoPlayNoPromise,\n  videoPlayPromise,\n  videoPlayPromiseFulfilled,\n  videoPlayPromiseRejected,\n  videoWarning\n} from '../actions'\nimport { VIDEO_ELEMENT_ID } from '../constants/dom'\nimport { VAST_QUARTILE_EVENT_TYPES } from '../constants/vast'\nimport { VIDEO_EVENT_TYPES, VIDEO_PROPERTY_NAMES } from '../constants/video'\nimport clamp from '../util/clamp'\nimport errorToString from '../util/errorToString'\nimport isThenable from '../util/isThenable'\nimport mapObject from '../util/mapObject'\nimport sharedDom from '../util/sharedDom'\nimport toJSON from '../util/toJSON'\n\nconst normalizeVideoProperties = video =>\n  mapObject(VIDEO_PROPERTY_NAMES, name => toJSON(video[name]))\n\nconst sumTimeRanges = ({ data }) =>\n  data.reduce((sum, { start, end }) => sum + end - start, 0)\n\nconst withoutApiFramework = ({ payload: { apiFramework } }) =>\n  apiFramework == null\n\nconst toVastMediaFileActionStream = action$ =>\n  action$.pipe(ofType(SET_MEDIA_FILE), filter(withoutApiFramework))\n\nconst videoElementUpdateEpic = action$ =>\n  action$.pipe(\n    ofType(REQUEST_VIDEO_ELEMENT_UPDATE),\n    map(() => document.getElementById(VIDEO_ELEMENT_ID) || null),\n    filter(videoElement => videoElement !== sharedDom.videoElement),\n    tap(videoElement => {\n      sharedDom.videoElement = videoElement\n    }),\n    map(videoElement => {\n      return videoElement != null ? setVideoElement() : unsetVideoElement()\n    })\n  )\n\nconst bootstrapVideoElementEpic = action$ =>\n  action$.pipe(\n    ofType(SET_VIDEO_ELEMENT),\n    mergeMapTo(\n      new Observable(observer => {\n        const { videoElement } = sharedDom\n        const doc = videoElement.ownerDocument\n        observer.next(\n          setVideoProperties(normalizeVideoProperties(videoElement))\n        )\n        const onVideoEvent = ({ type }) => {\n          observer.next(\n            setVideoProperties(normalizeVideoProperties(videoElement))\n          )\n          observer.next(videoEvent(type))\n        }\n        const onFullscreenchange = () => {\n          const isFullscreen = doc.fullscreenElement != null\n          observer.next(setAdFullscreen(isFullscreen))\n        }\n        for (const type of VIDEO_EVENT_TYPES) {\n          videoElement.addEventListener(type, onVideoEvent)\n        }\n        doc.addEventListener('fullscreenchange', onFullscreenchange)\n        return () => {\n          for (const type of VIDEO_EVENT_TYPES) {\n            videoElement.removeEventListener(type, onVideoEvent)\n          }\n          doc.removeEventListener('fullscreenchange', onFullscreenchange)\n        }\n      }).pipe(takeUntil(action$.pipe(ofType(END_TEST))))\n    )\n  )\n\nconst setVideoElementSourceEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    map(({ payload: { url } }) => setVideoSrc(url))\n  )\n\nconst toggleVideoPausedStateEpic = (action$, state$) =>\n  $combineLatest(\n    toVastMediaFileActionStream(action$),\n    action$.pipe(ofType(SET_VIDEO_ELEMENT))\n  ).pipe(\n    mergeMap(() => {\n      const {\n        video: { paused }\n      } = state$.value\n      const { videoElement } = sharedDom\n      return paused !== videoElement.paused\n        ? $of(setVideoPaused(paused))\n        : EMPTY$\n    })\n  )\n\nconst playPauseEpic = action$ =>\n  action$.pipe(\n    ofType(SET_VIDEO_PAUSED),\n    mergeMap(({ payload: { paused } }) => {\n      const { videoElement } = sharedDom\n      if (paused) {\n        videoElement.pause()\n        return EMPTY$\n      }\n      const maybeThenable = videoElement.play()\n      if (isThenable(maybeThenable)) {\n        return $concat(\n          $of(videoPlayPromise()),\n          $from(maybeThenable).pipe(\n            mapTo(videoPlayPromiseFulfilled()),\n            catchError(error =>\n              $of(videoPlayPromiseRejected(errorToString(error)))\n            )\n          )\n        )\n      } else {\n        return $of(videoPlayNoPromise())\n      }\n    })\n  )\n\nconst toVideoEventStream = (action$, desiredType) =>\n  action$.pipe(\n    ofType(VIDEO_EVENT),\n    filter(({ payload: { type } }) => type === desiredType)\n  )\n\nconst startAdEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(ofType(START_AD), takeUntil(action$.pipe(ofType(END_TEST))))\n    ),\n    mapTo(setVideoPaused(false))\n  )\n\nconst filterEnded = state$ =>\n  filter(() => {\n    const {\n      video: { properties }\n    } = state$.value\n    return !properties.ended\n  })\n\nconst videoEventToVastEventEpic = (\n  videoEventType,\n  vastEventType,\n  once = false,\n  unlessEnded = false\n) => (action$, state$) =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      toVideoEventStream(action$, videoEventType).pipe(\n        ...(once ? [take(1)] : []),\n        ...(unlessEnded ? [filterEnded(state$)] : []),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    mapTo(vastEvent(vastEventType))\n  )\n\nconst resumeEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      toVideoEventStream(action$, 'playing').pipe(\n        skip(1),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    mapTo(vastEvent('resume'))\n  )\n\nconst adStoppedEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(VAST_EVENT),\n        filter(({ payload: { type } }) => type === 'complete'),\n        mapTo(adStopped()),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst adErrorEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      $combineLatest(\n        toVideoEventStream(action$, 'error'),\n        action$.pipe(ofType(SET_VIDEO_PROPERTIES))\n      ).pipe(\n        take(1),\n        map(([, { payload: { properties: { error } } }]) =>\n          error != null ? error.message : null\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    map(message =>\n      adStopped('video', message != null ? message : 'Unknown error')\n    )\n  )\n\nconst quartilesEpic = (action$, state$) =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      toVideoEventStream(action$, 'timeupdate').pipe(\n        map(() => {\n          const {\n            video: {\n              properties: { played, duration }\n            }\n          } = state$.value\n          return duration > 0\n            ? clamp(Math.floor((sumTimeRanges(played) / duration) * 4), 0, 4)\n            : 0\n        }),\n        filter(quartile => quartile > 0),\n        distinct(),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    map(quartile => vastEvent(VAST_QUARTILE_EVENT_TYPES[quartile - 1]))\n  )\n\nconst videoEventToAdEventEpic = (videoEventType, adEvent) => action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      toVideoEventStream(action$, videoEventType).pipe(\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    mapTo(adEvent())\n  )\n\nconst bufferFinishEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      toVideoEventStream(action$, 'stalled').pipe(\n        mergeMapTo(toVideoEventStream(action$, 'canplay')),\n        take(1),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    ),\n    mapTo(adBufferFinish())\n  )\n\nconst videoPropertiesToAdStateEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(SET_VIDEO_PROPERTIES),\n        mergeMap(\n          ({\n            payload: {\n              properties: { paused, readyState, muted, volume }\n            }\n          }) => [\n            setAdPaused(paused || readyState < 3),\n            setAdMuted(muted || volume === 0)\n          ]\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdPausedEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_PAUSED),\n        map(({ payload: { paused } }) => setVideoPaused(paused)),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdMutedEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_MUTED),\n        map(({ payload: { muted } }) => setVideoMuted(muted)),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdFullscreenEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_FULLSCREEN),\n        mergeMap(({ payload: { fullscreen } }) => {\n          const { videoElement } = sharedDom\n          let subject, func\n          if (fullscreen) {\n            [subject, func] = [videoElement, 'requestFullscreen']\n          } else {\n            [subject, func] = [videoElement.ownerDocument, 'exitFullscreen']\n          }\n          if (typeof subject[func] !== 'function') {\n            return $of(\n              videoWarning(\n                `Fullscreen API not supported: ${func}() not available`\n              )\n            )\n          }\n          const promise = subject[func]()\n          return $of(promise).pipe(ignoreElements())\n        }),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdSkipEpic = action$ =>\n  toVastMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_SKIP),\n        mergeMapTo($of(setVideoSrc(null), vastEvent('skip'))),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nexport default combineEpics(\n  videoElementUpdateEpic,\n  bootstrapVideoElementEpic,\n  startAdEpic,\n  setVideoElementSourceEpic,\n  toggleVideoPausedStateEpic,\n  playPauseEpic,\n  videoEventToVastEventEpic('loadeddata', 'impression', true),\n  videoEventToVastEventEpic('canplay', 'loaded', true),\n  videoEventToVastEventEpic('playing', 'start', true),\n  resumeEpic,\n  videoEventToVastEventEpic('pause', 'pause', false, true),\n  quartilesEpic,\n  videoEventToAdEventEpic('volumechange', adVolumeChange),\n  videoEventToAdEventEpic('stalled', adBufferStart),\n  bufferFinishEpic,\n  videoEventToVastEventEpic('error', 'error', true),\n  videoPropertiesToAdStateEpic,\n  requestAdPausedEpic,\n  requestAdMutedEpic,\n  requestAdFullscreenEpic,\n  requestAdSkipEpic,\n  adStoppedEpic,\n  adErrorEpic\n)\n","export const VPAID_EVENT_NAMES = [\n  'AdLoaded',\n  'AdStarted',\n  'AdStopped',\n  'AdSkipped',\n  'AdSkippableStateChange',\n  'AdSizeChange',\n  'AdLinearChange',\n  'AdDurationChange',\n  'AdExpandedChange',\n  'AdRemainingTimeChange',\n  'AdVolumeChange',\n  'AdImpression',\n  'AdVideoStart',\n  'AdVideoFirstQuartile',\n  'AdVideoMidpoint',\n  'AdVideoThirdQuartile',\n  'AdVideoComplete',\n  'AdClickThru',\n  'AdInteraction',\n  'AdUserAcceptInvitation',\n  'AdUserMinimize',\n  'AdUserClose',\n  'AdPaused',\n  'AdPlaying',\n  'AdLog',\n  'AdError'\n]\n\nexport const VPAID_PROPERTY_NAMES = [\n  'adWidth',\n  'adHeight',\n  'adLinear',\n  'adExpanded',\n  'adSkippableState',\n  'adRemainingTime',\n  'adDuration',\n  'adVolume',\n  'adCompanions',\n  'adIcons'\n]\n\nexport const VPAID_EVENT_TYPE_TO_VAST_EVENT_TYPE = {\n  AdLoaded: 'loaded',\n  AdSkipped: 'skip',\n  AdStarted: 'creativeView',\n  AdImpression: 'impression',\n  AdVideoStart: 'start',\n  AdVideoFirstQuartile: 'firstQuartile',\n  AdVideoMidpoint: 'midpoint',\n  AdVideoThirdQuartile: 'thirdQuartile',\n  AdVideoComplete: 'complete',\n  AdUserAcceptInvitation: 'acceptInvitation',\n  AdUserMinimize: 'collapse',\n  AdUserClose: 'close',\n  AdPaused: 'pause',\n  AdPlaying: 'resume',\n  AdClickThru: 'clickThrough',\n  AdError: 'error'\n}\n","const loadScript = async (url, crossOrigin, doc) =>\n  new Promise((resolve, reject) => {\n    const script = doc.createElement('script')\n    doc.getElementsByTagName('head')[0].appendChild(script)\n    script.addEventListener('load', () => {\n      resolve(script)\n    })\n    script.addEventListener('error', () =>\n      reject(new Error(`Failed to load script: ${url}`))\n    )\n    script.crossOrigin = crossOrigin\n    script.src = url\n  })\n\nexport default loadScript\n","import { Subject } from 'rxjs'\n\nimport { VPAID_EVENT_NAMES } from '../constants/vpaid'\n\nexport const INVOKE = 'INVOKE'\nexport const RETURN_VALUE = 'RETURN_VALUE'\nexport const EVENT = 'EVENT'\n\nexport const invoke = (name, args, allowError = false) => ({\n  type: INVOKE,\n  payload: {\n    name,\n    args,\n    allowError\n  }\n})\n\nconst returnValue = (name, args, value) => ({\n  type: RETURN_VALUE,\n  payload: {\n    name,\n    args,\n    value\n  }\n})\n\nconst event = (name, data) => ({\n  type: EVENT,\n  payload: {\n    name,\n    data\n  }\n})\n\nconst attemptCall = (vpaid, name, args) => {\n  const func = vpaid[name]\n  if (typeof func !== 'function') {\n    throw new Error(`VPAID ${name} is not a function`)\n  }\n  return func.apply(vpaid, args)\n}\n\nconst vpaidObservable = vpaid => {\n  const in$ = new Subject()\n  const out$ = new Subject()\n  in$.subscribe(({ type, payload }) => {\n    if (type !== INVOKE) {\n      return\n    }\n    const { name, args, allowError } = payload\n    let error = null\n    let value = null\n    try {\n      value = attemptCall(vpaid, name, args)\n    } catch (err) {\n      error = new Error(`Error calling VPAID ${name}()`)\n      error.cause = err\n    }\n    if (error != null) {\n      if (allowError) {\n        // TODO Warn in app log (but only the first time?)\n        console.warn(error + (error.cause != null ? `: ${error.cause}` : ''))\n      } else {\n        out$.error(error)\n      }\n    } else {\n      out$.next(returnValue(name, args, value))\n    }\n  })\n  for (const name of VPAID_EVENT_NAMES) {\n    const listener = (...data) => {\n      out$.next(event(name, data))\n    }\n    in$.next(invoke('subscribe', [listener, name]))\n  }\n  return {\n    in$,\n    out$\n  }\n}\n\nexport default vpaidObservable\n","import { lowerCaseFirst } from 'lower-case-first'\nimport { combineEpics, ofType } from 'redux-observable'\nimport { interval as $interval, Observable, of as $of, Subject } from 'rxjs'\nimport {\n  catchError,\n  filter,\n  map,\n  mapTo,\n  mergeMap,\n  mergeMapTo,\n  take,\n  takeUntil,\n  tap\n} from 'rxjs/operators'\nimport { upperCaseFirst } from 'upper-case-first'\n\nimport {\n  adStopped,\n  adVolumeChange,\n  CALL_VPAID_FUNCTION,\n  callingVpaidFunction,\n  callVpaidFunction,\n  END_TEST,\n  loadVpaid,\n  REQUEST_AD_FULLSCREEN,\n  REQUEST_AD_MUTED,\n  REQUEST_AD_PAUSED,\n  REQUEST_AD_SKIP,\n  REQUEST_VPAID_DOM_UPDATE,\n  SET_CONFIG,\n  SET_MEDIA_FILE,\n  SET_VPAID_DOM,\n  SET_VPAID_PROPERTIES,\n  setAdMuted,\n  setAdPaused,\n  setVpaidDom,\n  setVpaidProperties,\n  START_AD,\n  START_VPAID_AD,\n  startVpaidAd,\n  unsetVpaidDom,\n  vastEvent,\n  VPAID_EVENT,\n  VPAID_LOADED,\n  vpaidAdObtained,\n  vpaidError,\n  vpaidEvent,\n  vpaidHandshakeSuccessful,\n  vpaidLoaded,\n  vpaidLoadFailed\n} from '../actions'\nimport { SLOT_ELEMENT_ID, VPAID_IFRAME_ID } from '../constants/dom'\nimport {\n  VPAID_EVENT_TYPE_TO_VAST_EVENT_TYPE,\n  VPAID_PROPERTY_NAMES\n} from '../constants/vpaid'\nimport { VPAID_PROPERTIES_UPDATE_INTERVAL } from '../settings'\nimport errorToString from '../util/errorToString'\nimport loadScript from '../util/loadScript'\nimport sharedDom from '../util/sharedDom'\nimport toJSON from '../util/toJSON'\nimport vpaidObservable, {\n  EVENT,\n  invoke,\n  RETURN_VALUE\n} from '../util/vpaidObservable'\n\nconst PLAY_EVENTS = ['AdStarted', 'AdVideoStart', 'AdPlaying']\nconst PAUSE_EVENTS = ['AdPaused', 'AdError', 'AdStopped']\n\nconst withVpaidApiFramework = ({ payload: { apiFramework } }) =>\n  apiFramework === 'VPAID'\n\nconst toVpaidMediaFileActionStream = action$ =>\n  action$.pipe(ofType(SET_MEDIA_FILE), filter(withVpaidApiFramework))\n\nconst vpaidIframeUpdateEpic = action$ =>\n  action$.pipe(\n    ofType(REQUEST_VPAID_DOM_UPDATE),\n    map(() => document.getElementById(VPAID_IFRAME_ID)),\n    filter(iframe => iframe !== sharedDom.vpaidIframe),\n    tap(iframe => {\n      sharedDom.vpaidIframe = iframe\n      if (iframe != null) {\n        const doc = iframe.contentWindow.document\n        sharedDom.slotElement = doc.getElementById(SLOT_ELEMENT_ID)\n      } else {\n        sharedDom.slotElement = null\n      }\n    }),\n    map(iframe => (iframe != null ? setVpaidDom() : unsetVpaidDom()))\n  )\n\nconst loadVpaidEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMap(({ payload: { url } }) =>\n      action$.pipe(\n        ofType(SET_VPAID_DOM),\n        mergeMapTo(\n          new Observable(observer => {\n            const dispatch = action => observer.next(action)\n            const { vpaidIframe: iframe } = sharedDom\n            const doc = iframe.contentWindow.document\n            dispatch(loadVpaid(url))\n            loadScript(url, null, doc).then(\n              () => {\n                dispatch(vpaidLoaded())\n              },\n              error => {\n                dispatch(vpaidLoadFailed(errorToString(error)))\n              }\n            )\n          })\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst runVpaidAd = (\n  win,\n  slotElement,\n  videoElement,\n  adParameters,\n  vpaidPropertiesAllowedBeforeAdLoaded,\n  action$\n) =>\n  new Observable(observer => {\n    const dispatch = action => observer.next(action)\n\n    let vpaidAd\n    try {\n      vpaidAd = win.getVPAIDAd()\n    } catch (error) {\n      observer.error(new Error(`Failed to get VPAID ad: ${error}`))\n      return\n    }\n    dispatch(vpaidAdObtained())\n\n    const { in$, out$ } = vpaidObservable(vpaidAd)\n\n    let adLoadedPublished = false\n\n    const call = (name, args = [], silent = false) => {\n      if (!silent) {\n        dispatch(callingVpaidFunction(name, toJSON(args)))\n      }\n      in$.next(invoke(name, args, silent))\n    }\n\n    const initAd = () => {\n      const doc = slotElement.ownerDocument\n      const win = doc.defaultView\n      const width = win.innerWidth\n      const height = win.innerHeight\n      const desiredBitrate = -1\n      const viewMode = 'normal'\n      const creativeData = {\n        AdParameters: adParameters\n      }\n      const environmentVars = {\n        slot: slotElement,\n        videoSlot: videoElement\n      }\n      call('initAd', [\n        width,\n        height,\n        viewMode,\n        desiredBitrate,\n        creativeData,\n        environmentVars\n      ])\n    }\n\n    let properties\n\n    const collectProperties = () => {\n      properties = {}\n      for (const name of VPAID_PROPERTY_NAMES) {\n        const getter = 'get' + upperCaseFirst(name)\n        call(getter, [], true)\n      }\n    }\n\n    const takeUntilEndTest = takeUntil(action$.pipe(ofType(END_TEST)))\n\n    const updateProperties$ = new Subject()\n    updateProperties$.pipe(takeUntilEndTest).subscribe(() => {\n      if (vpaidPropertiesAllowedBeforeAdLoaded || adLoadedPublished) {\n        collectProperties()\n        dispatch(setVpaidProperties(properties))\n      }\n    })\n\n    action$.pipe(ofType(START_VPAID_AD), takeUntilEndTest).subscribe(() => {\n      call('startAd')\n    })\n\n    action$\n      .pipe(ofType(CALL_VPAID_FUNCTION), takeUntilEndTest)\n      .subscribe(({ payload: { name, args } }) => {\n        call(name, args)\n      })\n\n    $interval(VPAID_PROPERTIES_UPDATE_INTERVAL)\n      .pipe(\n        takeUntilEndTest,\n        takeUntil(\n          action$.pipe(\n            ofType(VPAID_EVENT),\n            filter(\n              ({ payload: { name } }) =>\n                name === 'AdStopped' || name === 'AdError'\n            )\n          )\n        )\n      )\n      .subscribe(() => {\n        updateProperties$.next()\n      })\n\n    const returnValueHandlers = {\n      handshakeVersion: (args, value) => {\n        if (value !== '2.0') {\n          observer.error(\n            new Error(`Unexpected VPAID handshake response: ${value}`)\n          )\n        } else {\n          dispatch(vpaidHandshakeSuccessful(value))\n          initAd()\n        }\n      }\n    }\n\n    const eventHandlers = {\n      AdLoaded: () => {\n        adLoadedPublished = true\n      },\n      AdStopped: () => {\n        dispatch(adStopped())\n      },\n      AdError: data => {\n        const message = errorToString(data)\n        dispatch(adStopped('generic', message))\n        observer.error(new Error(`AdError: ${message}`))\n      }\n    }\n\n    const handlers = {\n      [RETURN_VALUE]: ({ name, args, value }) => {\n        if (name.startsWith('get')) {\n          const prop = lowerCaseFirst(name.substr(3))\n          properties[prop] = value\n        }\n        if (returnValueHandlers[name] != null) {\n          returnValueHandlers[name](args, value)\n        }\n      },\n      [EVENT]: ({ name, data }) => {\n        updateProperties$.next()\n        dispatch(vpaidEvent(name, data))\n        const vastEventType = VPAID_EVENT_TYPE_TO_VAST_EVENT_TYPE[name]\n        if (vastEventType != null) {\n          dispatch(vastEvent(vastEventType))\n        }\n        if (name === 'AdVolumeChange') {\n          dispatch(adVolumeChange())\n        }\n        if (eventHandlers[name] != null) {\n          eventHandlers[name](data)\n        }\n      }\n    }\n\n    out$.subscribe({\n      next: ({ type, payload }) => {\n        if (handlers[type] != null) {\n          handlers[type](payload)\n        }\n      },\n      error: error => {\n        observer.error(error)\n      },\n      complete: () => {\n        observer.complete()\n      }\n    })\n\n    call('handshakeVersion', ['2.0'])\n  })\n\nconst startVpaidEpic = (action$, state$) =>\n  action$.pipe(\n    ofType(VPAID_LOADED),\n    mergeMap(() => {\n      const { vpaidIframe: iframe, slotElement, videoElement } = sharedDom\n      const {\n        vast: { adParameters },\n        config: { vpaidPropertiesAllowedBeforeAdLoaded }\n      } = state$.value\n      return runVpaidAd(\n        iframe.contentWindow,\n        slotElement,\n        videoElement,\n        adParameters,\n        vpaidPropertiesAllowedBeforeAdLoaded,\n        action$\n      ).pipe(\n        takeUntil(action$.pipe(ofType(END_TEST))),\n        catchError(error =>\n          $of(\n            vpaidError(\n              errorToString(error),\n              error.cause != null ? error.cause.stack : null\n            )\n          )\n        )\n      )\n    })\n  )\n\nconst startAdEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(ofType(START_AD), takeUntil(action$.pipe(ofType(END_TEST))))\n    ),\n    mapTo(startVpaidAd())\n  )\n\nconst muteOnStartEpic = action$ =>\n  action$.pipe(\n    ofType(SET_CONFIG),\n    filter(({ payload: config }) => config != null && !config.audioUnmuted),\n    mergeMapTo(\n      action$.pipe(\n        ofType(VPAID_EVENT),\n        filter(({ payload: { name } }) => PLAY_EVENTS.indexOf(name) >= 0),\n        take(1),\n        mapTo(callVpaidFunction('setAdVolume', [0])),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst vpaidEventsToPausedEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(VPAID_EVENT),\n        map(({ payload: { name } }) =>\n          PLAY_EVENTS.indexOf(name) >= 0\n            ? false\n            : PAUSE_EVENTS.indexOf(name) >= 0\n              ? true\n              : null\n        ),\n        filter(value => typeof value === 'boolean'),\n        map(paused => setAdPaused(paused)),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst vpaidVolumeToMutedEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(SET_VPAID_PROPERTIES),\n        map(({ payload: { properties: { adVolume } } }) =>\n          setAdMuted(adVolume === 0)\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdPausedEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_PAUSED),\n        map(({ payload: { paused } }) =>\n          callVpaidFunction(paused ? 'pauseAd' : 'resumeAd')\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdMutedEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_MUTED),\n        map(({ payload: { muted } }) =>\n          callVpaidFunction('setAdVolume', [muted ? 0 : 1])\n        ),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst isStrictlyPositive = val => isFinite(val) && val > 0\n\nconst requestAdFullscreenEpic = (action$, state$) =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_FULLSCREEN),\n        map(({ payload: { fullscreen } }) => {\n          const {\n            vpaid: {\n              properties: { adWidth, adHeight }\n            }\n          } = state$.value\n          const [width, height] =\n            isStrictlyPositive(adWidth) && isStrictlyPositive(adHeight)\n              ? [adWidth, adHeight]\n              : [sharedDom.videoSlot.width, sharedDom.videoSlot.height]\n          return callVpaidFunction('resizeAd', [\n            width,\n            height,\n            fullscreen ? 'fullscreen' : 'normal'\n          ])\n        }),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nconst requestAdSkipEpic = action$ =>\n  toVpaidMediaFileActionStream(action$).pipe(\n    mergeMapTo(\n      action$.pipe(\n        ofType(REQUEST_AD_SKIP),\n        mapTo(callVpaidFunction('skipAd')),\n        takeUntil(action$.pipe(ofType(END_TEST)))\n      )\n    )\n  )\n\nexport default combineEpics(\n  vpaidIframeUpdateEpic,\n  loadVpaidEpic,\n  startVpaidEpic,\n  startAdEpic,\n  muteOnStartEpic,\n  vpaidEventsToPausedEpic,\n  vpaidVolumeToMutedEpic,\n  requestAdPausedEpic,\n  requestAdMutedEpic,\n  requestAdFullscreenEpic,\n  requestAdSkipEpic\n)\n","import adEpic from './ad'\nimport configEpic from './config'\nimport testEpic from './test'\nimport vastTrackingEpic from './tracking'\nimport vastEpic from './vast'\nimport verificationEpic from './verification'\nimport videoEpic from './video'\nimport vpaidEpic from './vpaid'\n\nexport default [\n  configEpic,\n  testEpic,\n  adEpic,\n  vastEpic,\n  vastTrackingEpic,\n  verificationEpic,\n  videoEpic,\n  vpaidEpic\n]\n","import historyMiddleware from './history'\n\nexport default [historyMiddleware]\n","import { handleActions } from 'redux-actions'\n\nimport {\n  SET_AD_ACTIVE,\n  SET_AD_FULLSCREEN,\n  SET_AD_MUTED,\n  SET_AD_PAUSED,\n  START_TEST\n} from '../actions'\n\nconst defaultState = () => ({\n  active: false,\n  muted: false,\n  fullscreen: false,\n  paused: true\n})\n\nconst reducer = handleActions(\n  {\n    [START_TEST]: defaultState,\n    [SET_AD_ACTIVE]: (state, { payload: { active } }) => ({\n      ...state,\n      active\n    }),\n    [SET_AD_MUTED]: (state, { payload: { muted } }) => ({\n      ...state,\n      muted\n    }),\n    [SET_AD_FULLSCREEN]: (state, { payload: { fullscreen } }) => ({\n      ...state,\n      fullscreen\n    }),\n    [SET_AD_PAUSED]: (state, { payload: { paused } }) => ({\n      ...state,\n      paused\n    })\n  },\n  defaultState()\n)\n\nexport default reducer\n","import { handleActions } from 'redux-actions'\n\nimport { SET_CONFIG } from '../actions'\n\nconst defaultState = () => null\n\nconst reducer = handleActions(\n  {\n    [SET_CONFIG]: (state, { payload }) => payload\n  },\n  defaultState()\n)\n\nexport default reducer\n","const isEmpty = obj => {\n  if (obj == null) {\n    return true\n  }\n  if (Array.isArray(obj)) {\n    return obj.length === 0\n  }\n  return Object.keys(obj).length === 0\n}\n\nexport default isEmpty\n","import {\n  CALLING_VPAID_FUNCTION,\n  LOAD_VAST,\n  LOAD_VPAID,\n  REQUEST_AD_SKIP,\n  SCHEDULE_AD_START,\n  SET_CONFIG,\n  SET_MEDIA_FILE,\n  SET_VIDEO_MUTED,\n  SET_VIDEO_PAUSED,\n  START_AD,\n  START_TEST,\n  UNSUPPORTED_MEDIA_FILES,\n  VAST_EVENT,\n  VAST_LOAD_FAILED,\n  VAST_LOADED,\n  VAST_TRACKER,\n  VAST_WARNING,\n  VERIFICATION_ERROR_EVENT,\n  VERIFICATION_EVENT,\n  VERIFICATION_READY,\n  VERIFICATION_SESSION_FINISHED,\n  VIDEO_EVENT,\n  VIDEO_PLAY_NO_PROMISE,\n  VIDEO_PLAY_PROMISE,\n  VIDEO_PLAY_PROMISE_FULFILLED,\n  VIDEO_PLAY_PROMISE_REJECTED,\n  VPAID_ERROR,\n  VPAID_EVENT,\n  VPAID_HANDSHAKE_SUCCESSFUL,\n  VPAID_LOAD_FAILED,\n  VPAID_LOADED,\n  VPAID_WARNING\n} from '../actions'\nimport { PRELOAD_SIMULATION_TIME } from '../settings'\nimport isEmpty from '../util/isEmpty'\nimport msToString from '../util/msToString'\n\nconst LOGGED_VIDEO_EVENTS = [\n  'loadedmetadata',\n  'loadeddata',\n  'canplay',\n  'canplaythrough',\n  'waiting',\n  'play',\n  'playing',\n  'pause',\n  'ended',\n  'volumechange',\n  'error'\n]\n\nconst INFO = 'info'\nconst WARN = 'warn'\nconst ERROR = 'error'\n\nconst VAST = 'VAST'\nconst VPAID = 'VPAID'\nconst VIDEO = 'video'\nconst OMID = 'OMID'\n\nconst HANDLERS = {\n  [VAST_WARNING]: ({ message, url }) => ({\n    category: VAST,\n    text: `Tag ${url} warning: ${message}`,\n    level: WARN\n  }),\n  [LOAD_VAST]: {\n    category: VAST,\n    text: 'Loading tag'\n  },\n  [VAST_LOADED]: {\n    category: VAST,\n    text: 'Tag loaded'\n  },\n  [VAST_LOAD_FAILED]: ({ error }) => ({\n    category: VAST,\n    text: `Failed to load tag: ${error}`,\n    level: ERROR\n  }),\n  [UNSUPPORTED_MEDIA_FILES]: {\n    category: VAST,\n    text: 'No supported media files found'\n  },\n  [VAST_EVENT]: ({ type }) => ({\n    category: VAST,\n    text: `Event: ${type}`\n  }),\n  [VAST_TRACKER]: ({ type, uri }) => ({\n    category: VAST,\n    text: `Tracking ${type} tracker: ${uri}`\n  }),\n  [SET_MEDIA_FILE]: ({ url, apiFramework }) => ({\n    category: apiFramework != null ? VPAID : VIDEO,\n    text: url == null ? 'Unloading media' : `Loading: ${url}`\n  }),\n  [SCHEDULE_AD_START]: ({ delayed }) => ({\n    category: VAST,\n    text: delayed\n      ? `Simulating preloading for ${msToString(PRELOAD_SIMULATION_TIME)}`\n      : 'Starting ad'\n  }),\n  [START_AD]: ({ delayed }) =>\n    delayed\n      ? {\n          category: VAST,\n          text: 'Starting ad' + (delayed ? ' after simulated preloading' : '')\n        }\n      : null,\n  [REQUEST_AD_SKIP]: {\n    category: VAST,\n    text: 'Ad skip requested'\n  },\n  [VIDEO_EVENT]: ({ type }) =>\n    LOGGED_VIDEO_EVENTS.includes(type)\n      ? {\n          category: VIDEO,\n          text: `Event: ${type}`\n        }\n      : null,\n  [SET_VIDEO_PAUSED]: ({ paused }) => ({\n    category: VIDEO,\n    text: paused ? 'Pausing' : 'Playing'\n  }),\n  [SET_VIDEO_MUTED]: ({ muted }) => ({\n    category: VIDEO,\n    text: muted ? 'Muting' : 'Unmuting'\n  }),\n  [VIDEO_PLAY_NO_PROMISE]: {\n    category: VIDEO,\n    text: 'Call to play() did not return promise'\n  },\n  [VIDEO_PLAY_PROMISE]: {\n    category: VIDEO,\n    text: 'Call to play() returned promise'\n  },\n  [VIDEO_PLAY_PROMISE_FULFILLED]: {\n    category: VIDEO,\n    text: 'Promise from play() call fulfilled'\n  },\n  [VIDEO_PLAY_PROMISE_REJECTED]: ({ error }) => ({\n    category: VIDEO,\n    text: `Promise from play() call rejected: ${error}`\n  }),\n  [LOAD_VPAID]: ({ url }) => ({\n    category: VPAID,\n    text: `Loading script: ${url}`\n  }),\n  [VPAID_LOADED]: {\n    category: VPAID,\n    text: 'Script loaded'\n  },\n  [VPAID_LOAD_FAILED]: ({ error }) => ({\n    category: VPAID,\n    text: `Failed to load script: ${error}`,\n    level: ERROR\n  }),\n  [VPAID_HANDSHAKE_SUCCESSFUL]: ({ response }) => ({\n    category: VPAID,\n    text: `Handshake successful: got version ${response}`\n  }),\n  [CALLING_VPAID_FUNCTION]: ({ name, args }) =>\n    name.startsWith('get')\n      ? null\n      : {\n          category: VPAID,\n          text: `Calling function ${name}`,\n          metadata: isEmpty(args) ? null : { Args: args }\n        },\n  [VPAID_EVENT]: ({ name, data }) =>\n    name === 'AdRemainingTimeChange'\n      ? null\n      : {\n          category: VPAID,\n          text: `Event: ${name}`,\n          metadata: isEmpty(data) ? null : { Data: data }\n        },\n  [VPAID_WARNING]: ({ message }) => ({\n    category: VPAID,\n    text: message,\n    level: WARN\n  }),\n  [VPAID_ERROR]: ({ message, cause }) => ({\n    category: VPAID,\n    text: message,\n    level: ERROR,\n    metadata: cause == null ? null : { Cause: cause }\n  }),\n  [VERIFICATION_READY]: ({ enabled }) =>\n    enabled\n      ? {\n          category: OMID,\n          text: 'Session started'\n        }\n      : null,\n  [VERIFICATION_SESSION_FINISHED]: {\n    category: OMID,\n    text: 'Session finished'\n  },\n  [VERIFICATION_EVENT]: ({ type }) => ({\n    category: OMID,\n    text: `Event: ${type}`\n  }),\n  [VERIFICATION_ERROR_EVENT]: ({ errorType, message }) => ({\n    category: OMID,\n    text: `${message} (type: ${errorType})`,\n    level: ERROR\n  })\n}\n\nconst defaultState = () => ({\n  consoleEnabled: false,\n  events: []\n})\n\nconst reducer = (state = defaultState(), { type, payload }) => {\n  if (type === START_TEST) {\n    return {\n      ...state,\n      events: []\n    }\n  }\n  if (type === SET_CONFIG) {\n    if (payload == null) {\n      return state\n    }\n    return {\n      ...state,\n      consoleEnabled: payload.consoleEnabled\n    }\n  }\n  if (Object.prototype.hasOwnProperty.call(HANDLERS, type)) {\n    const handler = HANDLERS[type]\n    const result = typeof handler === 'function' ? handler(payload) : handler\n    if (result != null) {\n      const { category, level = INFO, text, metadata } = result\n      if (state.consoleEnabled && typeof console[level] === 'function') {\n        console[level](\n          `[${category}] ${text}` +\n            (metadata != null ? '\\nData: ' + JSON.stringify(metadata) : '')\n        )\n      }\n      return {\n        ...state,\n        events: [\n          ...state.events,\n          {\n            timestamp: Date.now(),\n            category,\n            level,\n            text,\n            metadata\n          }\n        ]\n      }\n    }\n  }\n  return state\n}\n\nexport default reducer\n","const incrementCounter = (counts, key) => ({\n  ...counts,\n  [key]: (counts[key] || 0) + 1\n})\n\nexport default incrementCounter\n","import { handleActions } from 'redux-actions'\n\nimport { SET_MEDIA_FILE, START_TEST, VAST_EVENT, VAST_LOADED } from '../actions'\nimport { VAST_EVENT_TYPES } from '../constants/vast'\nimport incrementCounter from '../util/incrementCounter'\nimport mapObject from '../util/mapObject'\n\nconst defaultState = () => ({\n  chain: null,\n  inLine: null,\n  linear: null,\n  trackingEvents: null,\n  mediaFile: null,\n  verifications: null,\n  eventCounts: mapObject(VAST_EVENT_TYPES, 0)\n})\n\nconst reducer = handleActions(\n  {\n    [START_TEST]: defaultState,\n    [VAST_LOADED]: (\n      state,\n      { payload: { chain, inLine, linear, trackingEvents, verifications } }\n    ) => ({\n      ...state,\n      chain,\n      inLine,\n      linear,\n      trackingEvents,\n      verifications\n    }),\n    [SET_MEDIA_FILE]: (\n      state,\n      { payload: { url, apiFramework, adParameters } }\n    ) => ({\n      ...state,\n      mediaFile: {\n        url,\n        apiFramework\n      },\n      adParameters\n    }),\n    [VAST_EVENT]: (state, { payload: { type } }) => ({\n      ...state,\n      eventCounts: incrementCounter(state.eventCounts, type)\n    })\n  },\n  defaultState()\n)\n\nexport default reducer\n","import { handleActions } from 'redux-actions'\n\nimport { START_TEST, VAST_LOADED, VERIFICATION_EVENT } from '../actions'\nimport { VERIFICATION_EVENT_TYPES } from '../constants/verification'\nimport incrementCounter from '../util/incrementCounter'\nimport mapObject from '../util/mapObject'\n\nconst defaultState = () => ({\n  accessMode: null,\n  scripts: null,\n  eventCounts: mapObject(VERIFICATION_EVENT_TYPES, 0)\n})\n\nconst reducer = handleActions(\n  {\n    [START_TEST]: (state, { payload: { omAccessMode } }) => ({\n      ...defaultState(),\n      accessMode: omAccessMode\n    }),\n    [VAST_LOADED]: (state, { payload: { verifications } }) => ({\n      ...state,\n      scripts: verifications\n    }),\n    [VERIFICATION_EVENT]: (state, { payload: { type } }) => ({\n      ...state,\n      eventCounts: incrementCounter(state.eventCounts, type)\n    })\n  },\n  defaultState()\n)\n\nexport default reducer\n","import { handleActions } from 'redux-actions'\n\nimport {\n  SET_MEDIA_FILE,\n  SET_VIDEO_MUTED,\n  SET_VIDEO_PAUSED,\n  SET_VIDEO_PROPERTIES,\n  SET_VIDEO_SRC,\n  START_TEST,\n  VIDEO_EVENT\n} from '../actions'\nimport { VIDEO_EVENT_TYPES, VIDEO_PROPERTY_NAMES } from '../constants/video'\nimport incrementCounter from '../util/incrementCounter'\nimport mapObject from '../util/mapObject'\n\nconst defaultEventCounts = () => mapObject(VIDEO_EVENT_TYPES, 0)\n\nconst defaultProperties = () => mapObject(VIDEO_PROPERTY_NAMES, '')\n\nconst defaultState = () => ({\n  eventCounts: defaultEventCounts(),\n  properties: defaultProperties(),\n  shared: false,\n  src: null,\n  muted: false,\n  paused: true\n})\n\nconst reducer = handleActions(\n  {\n    [START_TEST]: defaultState,\n    [SET_MEDIA_FILE]: (state, { payload: { apiFramework } }) => {\n      const isVpaid = apiFramework != null\n      return {\n        ...state,\n        shared: isVpaid\n      }\n    },\n    [SET_VIDEO_PAUSED]: (state, { payload: { paused } }) => ({\n      ...state,\n      paused\n    }),\n    [SET_VIDEO_SRC]: (state, { payload: { src } }) => ({\n      ...state,\n      src\n    }),\n    [SET_VIDEO_MUTED]: (state, { payload: { muted } }) => ({\n      ...state,\n      muted\n    }),\n    [SET_VIDEO_PROPERTIES]: (state, { payload: { properties } }) => ({\n      ...state,\n      properties\n    }),\n    [VIDEO_EVENT]: (state, { payload: { type } }) => ({\n      ...state,\n      eventCounts: incrementCounter(state.eventCounts, type)\n    })\n  },\n  defaultState()\n)\n\nexport default reducer\n","import { handleActions } from 'redux-actions'\n\nimport {\n  CALLING_VPAID_FUNCTION,\n  SET_VPAID_PROPERTIES,\n  START_TEST,\n  VPAID_EVENT\n} from '../actions'\nimport { VPAID_EVENT_NAMES, VPAID_PROPERTY_NAMES } from '../constants/vpaid'\nimport incrementCounter from '../util/incrementCounter'\nimport mapObject from '../util/mapObject'\n\nconst defaultEventCounts = () => mapObject(VPAID_EVENT_NAMES, 0)\n\nconst defaultProperties = () => mapObject(VPAID_PROPERTY_NAMES, '')\n\nconst defaultState = () => ({\n  eventCounts: defaultEventCounts(),\n  properties: defaultProperties(),\n  status: ''\n})\n\nconst operationToStatus = {\n  initAd: 'loading',\n  startAd: 'starting',\n  stopAd: 'stopping'\n}\n\nconst eventToStatus = {\n  AdLoaded: 'loaded',\n  AdStarted: 'started',\n  AdStopped: 'stopped',\n  AdError: 'error'\n}\n\nconst reducer = handleActions(\n  {\n    [START_TEST]: defaultState,\n    [SET_VPAID_PROPERTIES]: (state, { payload: { properties } }) => ({\n      ...state,\n      properties\n    }),\n    [CALLING_VPAID_FUNCTION]: (state, { payload: { name } }) => ({\n      ...state,\n      status: operationToStatus[name] || state.status\n    }),\n    [VPAID_EVENT]: (state, { payload: { name } }) => ({\n      ...state,\n      status: eventToStatus[name] || state.status,\n      eventCounts: incrementCounter(state.eventCounts, name)\n    })\n  },\n  defaultState()\n)\n\nexport default reducer\n","import { combineReducers } from 'redux'\n\nimport ad from './ad'\nimport config from './config'\nimport log from './log'\nimport vast from './vast'\nimport verification from './verification'\nimport video from './video'\nimport vpaid from './vpaid'\n\nconst reducer = combineReducers({\n  config,\n  vast,\n  ad,\n  video,\n  vpaid,\n  verification,\n  log\n})\n\nexport default reducer\n"],"sourceRoot":""}